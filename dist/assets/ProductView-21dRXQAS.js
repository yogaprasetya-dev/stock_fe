import{_ as j}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{P as $}from"./product.service-8g3w9OI2.js";import{_ as z}from"./api.service-Dgs1boU1.js";import{_ as M}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as q}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Cvyx0ufE.js";import{u as L,v as i,a5 as Q,y as G,K as W,q as X,a6 as Y,o as V,c as H,a7 as Z,z as c,b as n,M as ee,I as A,a4 as T,E as ae,J as te,L as le,p as J,w as R,F as oe,r as se,D as ie,t as re,x as ne}from"./index-DOh3iN_U.js";import{_ as ue}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{e as w}from"./index-CFjhT2rJ.js";import{f as I}from"./data.utils-Cp1LBIu0.js";import{_ as de}from"./InputNumber.vue_vue_type_script_setup_true_lang-DaGHc2o6.js";import{_ as ce}from"./Dialog.vue_vue_type_script_setup_true_lang-BwIWKMFo.js";import{_ as me,a as ve}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{_ as K}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import{_ as F}from"./MultiSelect.vue_vue_type_script_setup_true_lang-kuuDsZfP.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./auth.service-BxJEy6Ur.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";import"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import"./index-QsIXXSH_.js";const pe={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},be=L({inheritAttrs:!1,__name:"ProductFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(U,{emit:b}){const g=i(4),f=i(),r=i(),u=i(),m=i([]),y=i([]),h=i([]),d=i([]),o=i([]),x=Q(!1),S=i(null),v=U,k=b;G(()=>{D(),w.on("show-filter",B)}),W(()=>{w.off("show-filter",B)});const O=()=>{const s={};if(w.emit("multi-select:hide-overlay"),f.value&&f.value.length>0&&(s.brand=JSON.stringify(f.value)),r.value&&r.value.length>0&&(s.category=JSON.stringify(r.value)),u.value&&u.value.length>0&&(s.unit=JSON.stringify(u.value)),d.value&&d.value.length>0){const t=d.value[0]?new Date(d.value[0]):null,l=d.value[1]?new Date(d.value[1]):new Date(d.value[0]),e=[t];l&&e.push(l),s.updatedAt=JSON.stringify(e)}if(o.value&&o.value.length>0){const t=o.value[0]?new Date(o.value[0]):null,l=o.value[1]?new Date(o.value[1]):new Date(o.value[0]),e=[t];l&&e.push(l),s.createdAt=JSON.stringify(e)}w.emit("data-table:apply-filter",{tableName:v==null?void 0:v.tableName,filter:s}),w.emit("data-table:clear-selected-data",{tableName:v==null?void 0:v.tableName}),k==null||k("apply",s)},C=()=>{f.value=[],r.value=[],u.value=[],d.value=[],o.value=[]},B=s=>{s.tableName===v.tableName&&(x.value=s.show)},D=()=>{if(S.value){const{children:s}=S.value,t=S.value.childElementCount,l=t%g.value;let[e,a]=[1,1];for(const P in Array.from({length:t})){const N=Number(P)===t-1;s[P].setAttribute("style",`grid-area: ${e}/${N&&l?g.value:a}`),++a>g.value&&(a=1,e++)}}},_=async s=>{try{let t={};s==="brand"&&(t.brand=JSON.stringify(!0)),s==="category"&&(t.category=JSON.stringify(!0)),s==="unit"&&(t.unit=JSON.stringify(!0));const{data:l}=await $.getProductOption(t);m.value=l.data.brand,y.value=l.data.category,h.value=l.data.unit}catch(t){console.error("Error fetching filter options:",t)}};return(s,t)=>X((V(),H("div",{ref_key:"container",ref:S,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3 overflow-scroll",style:Z(`grid-template-columns: repeat(${g.value}, 1fr)`)},[c("div",null,[n(F,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=l=>f.value=l),options:m.value,onShow:t[1]||(t[1]=l=>_("brand")),controls:"",label:"Brand",placeholder:"Pilih Brand","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),c("div",null,[n(F,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=l=>r.value=l),options:y.value,onShow:t[3]||(t[3]=l=>_("category")),controls:"",label:"Kategori",placeholder:"Pilih Kategori","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),c("div",null,[n(F,{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=l=>u.value=l),options:h.value,onShow:t[5]||(t[5]=l=>_("unit")),controls:"",label:"Satuan",placeholder:"Pilih Satuan","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),c("div",null,[n(K,{"model-value":d.value,"onUpdate:modelValue":t[6]||(t[6]=l=>d.value=l),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),c("div",null,[n(K,{"model-value":o.value,"onUpdate:modelValue":t[7]||(t[7]=l=>o.value=l),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),c("div",pe,[n(M,{onClick:C,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),n(M,{onClick:O,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[Y,x.value]])}}),fe={class:"flex flex-col gap-2 text-black overflow-x-auto w-full"},ye={class:"flex flex-col gap-2"},he={class:"flex flex-row justify-start gap-2"},ge={class:"w-full flex justify-end gap-2"},ke={class:"w-full"},Qe=L({__name:"ProductView",setup(U){const b=ee(),g=ae(),f=te();G(()=>{var a;const e=JSON.parse(localStorage.getItem("user"));d.value=(a=e==null?void 0:e.role)==null?void 0:a.name});const r=i({visible:!1,type:"add",header:"Tambah Kategori",useStay:!1}),u=i(),m=i(),y=i([]),h=i([]),d=i(),o=i({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),x=A(()=>{var e;return[{label:"Edit Produk",icon:"edit",visible:T("product").update,command:()=>{var a;sessionStorage.setItem("product",JSON.stringify((a=m.value)==null?void 0:a.id)),g.push("/product/data/edit")}},{label:"Edit Batas Stok",icon:"edit",visible:((e=d.value)==null?void 0:e.toLowerCase())==="owner",command:()=>{var a;u.value=(a=m.value)==null?void 0:a.threshold,r.value={visible:!0,type:"edit",header:"Edit Batas Stok",useStay:!1}}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:T("product").delete,command:()=>{h.value=[m.value],o.value={visible:!0,header:"Hapus Barang",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus Barang ini?",list:h.value.map(a=>a.name),confirmLabel:"Hapus",actionable:!0}}}]}),S=A(()=>[{label:"Hapus",icon:"delete-bin",visible:T("product").delete,danger:!0,command:()=>{h.value=y.value,o.value={visible:!0,header:"Edit Barang",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus barang ini?",list:h.value.map(e=>e.name),confirmLabel:"Ubah",actionable:!0}}}]),v=[{header:"Kode Produk",field:"code",sortable:!0,bodyTemplate:e=>e.code?e.code:"-"},{header:"Nama Produk",field:"name",sortable:!0,bodyTemplate:e=>e.name?e.name:"-"},{header:"Deskripsi",field:"description",sortable:!0,bodyTemplate:e=>e.description?e.description:"-"},{header:"Merek",field:"brand.name",sortable:!0,bodyTemplate:e=>e.brand?e.brand.name:"-"},{header:"Kategori",field:"category.name",sortable:!0,bodyTemplate:e=>e.category?e.category.name:"-"},{header:"Batas Stok",field:"threshold",sortable:!0,bodyTemplate:e=>e.threshold!==void 0?e.threshold.toString():"-"},{header:"Satuan",field:"unit.name",sortable:!0,bodyTemplate:e=>e.unit?e.unit.name:"-"},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?I(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?I(new Date(e.createdAt)):"-"}],k=A(()=>f.path.split("/").pop()),O=A(()=>y.value.length>0),C=()=>{g.push("/product/data/add")},B=()=>{u.value=void 0},D=()=>{t()},_=async()=>{await l(h.value.map(e=>e.id))},s=async e=>{try{const{data:a}=await $.getProduct(e);return a}catch(a){console.error("Error fetching data:",a)}},t=async()=>{var e;try{if(u.value===void 0){b.add({severity:"warn",summary:"Peringatan",detail:"Batas stok tidak boleh kosong",life:3e3});return}const a={threshold:u.value};await $.updateThreshold((e=m==null?void 0:m.value)==null?void 0:e.id,a),b.add({severity:"success",summary:"Berhasil",detail:"Batas stok berhasil diperbarui",life:3e3}),r.value.visible=!1,y.value=[],w.emit("data-table:update",{tableName:"table-product"})}catch(a){console.error("Error updating threshold:",a),b.add({severity:"error",summary:"Gagal",detail:"Gagal memperbarui batas stok",life:3e3})}},l=async e=>{try{if(e.length===0){b.add({severity:"warn",summary:"Peringatan",detail:"Tidak ada produk yang dipilih untuk dihapus",life:3e3});return}const a={id:e};await $.deleteProduct(a),b.add({severity:"success",summary:"Berhasil",detail:"Produk berhasil dihapus",life:3e3}),y.value=[],w.emit("data-table:update",{tableName:"table-product"})}catch(a){console.error("Error deleting product:",a),b.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus produk",life:3e3})}};return le(()=>r.value.visible,()=>{r.value.visible||B()},{immediate:!0}),(e,a)=>{var N,E;const P=se("router-view");return k.value==="add"||k.value==="edit"||k.value==="detail"?(V(),J(P,{key:0})):(V(),H(oe,{key:1},[n(z,null,{default:R(()=>[c("div",fe,[c("div",ye,[c("div",he,[n(q,{options:S.value,class:ie(`${O.value?"flex":"!hidden"} h-[21px] w-[120px]`)},null,8,["options","class"]),c("div",ge,[n(me,{"table-name":"table-product"}),n(ve,{"table-name":"table-product"}),ne(T)("product").create?(V(),J(M,{key:0,onClick:C,label:"Tambah Barang",severity:"primary",class:"text-xs"})):re("",!0)])]),n(be,{"table-name":"table-product"}),n(j,{"data-key":"id","fetch-function":s,columns:v,options:x.value,onToggleOption:a[0]||(a[0]=p=>m.value=p),"onUpdate:selectedData":a[1]||(a[1]=p=>y.value=p),"table-name":"table-product","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),n(ce,{visible:r.value.visible,"onUpdate:visible":[a[3]||(a[3]=p=>r.value.visible=p),r.value.visible],header:(N=r.value)==null?void 0:N.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(E=r.value)==null?void 0:E.useStay,"use-close":!0,closable:!1,onSubmit:D},{default:R(()=>[c("div",ke,[n(de,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=p=>u.value=p),label:"Batas Stok",placeholder:"Masukkan batas stok"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),n(ue,{visible:o.value.visible,"onUpdate:visible":a[4]||(a[4]=p=>o.value.visible=p),onConfirm:_,header:o.value.header,"header-icon":"check",list:o.value.list,message:o.value.message,severity:o.value.severity,"confirm-button-severity":o.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64))}}});export{Qe as default};
