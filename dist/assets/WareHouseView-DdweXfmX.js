import{_ as I}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{_ as W}from"./Breadcrumb.vue_vue_type_script_setup_true_lang-BPPSNlYI.js";import{S as C}from"./store.service-DK6LsYTS.js";import{_ as j}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Cvyx0ufE.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as z}from"./Dialog.vue_vue_type_script_setup_true_lang-BwIWKMFo.js";import{_ as K}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{_ as Q}from"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import{e as k}from"./index-CFjhT2rJ.js";import{f as G}from"./data.utils-Cp1LBIu0.js";import{_ as X}from"./api.service-Dgs1boU1.js";import{S as R}from"./stock.service-C4NW6Gnu.js";import{u as L,v as r,a5 as Y,y as Z,K as ee,q as ae,a6 as te,o as F,c as q,a7 as le,z as c,b as i,M as oe,I as P,a4 as V,L as se,w as H,F as ie,D as re,p as ne,t as ue,x as de,E as ce}from"./index-DOh3iN_U.js";import{_ as me}from"./Badge.vue_vue_type_script_setup_true_lang-BSKQkbi2.js";import{_ as ve,a as pe}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{_ as J}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import{_ as M}from"./MultiSelect.vue_vue_type_script_setup_true_lang-kuuDsZfP.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";import"./auth.service-BxJEy6Ur.js";import"./index-QsIXXSH_.js";const fe={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},be=L({inheritAttrs:!1,__name:"WareHouseFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(E,{emit:n}){const S=r(4),u=r(),s=r(),m=r(),w=r([]),d=r([]),g=r([{label:"Aktif",value:"active"},{label:"Tidak Aktif",value:"inactive"}]),v=r([]),p=r([]),$=Y(!1),_=r(null),h=E,x=n;Z(()=>{D(),k.on("show-filter",T)}),ee(()=>{k.off("show-filter",T)});const B=()=>{const o={};if(k.emit("multi-select:hide-overlay"),u.value&&u.value.length>0&&(o.brand=JSON.stringify(u.value)),s.value&&s.value.length>0&&(o.product=JSON.stringify(s.value)),m.value&&m.value.length>0&&(o.status=JSON.stringify(m.value)),v.value&&v.value.length>0){const a=v.value[0]?new Date(v.value[0]):null,l=v.value[1]?new Date(v.value[1]):new Date(v.value[0]),f=[a];l&&f.push(l),o.updatedAt=JSON.stringify(f)}if(p.value&&p.value.length>0){const a=p.value[0]?new Date(p.value[0]):null,l=p.value[1]?new Date(p.value[1]):new Date(p.value[0]),f=[a];l&&f.push(l),o.createdAt=JSON.stringify(f)}k.emit("data-table:apply-filter",{tableName:h==null?void 0:h.tableName,filter:o}),k.emit("data-table:clear-selected-data",{tableName:h==null?void 0:h.tableName}),x==null||x("apply",o)},O=()=>{u.value=[],s.value=[],m.value=[],v.value=[],p.value=[]},T=o=>{o.tableName===h.tableName&&($.value=o.show)},D=()=>{if(_.value){const{children:o}=_.value,a=_.value.childElementCount,l=a%S.value;let[f,e]=[1,1];for(const t in Array.from({length:a})){const b=Number(t)===a-1;o[t].setAttribute("style",`grid-area: ${f}/${b&&l?S.value:e}`),++e>S.value&&(e=1,f++)}}},A=async o=>{try{let a={};o==="brand"&&(a.brand=JSON.stringify(!0)),o==="product"&&(a.product=JSON.stringify(!0)),o==="status"&&(g.value=[{label:"Tersedia",value:"available"},{label:"Stok Rendah",value:"lowStock"},{label:"Habis",value:"outOfStock"}]);const{data:l}=await R.getWarehouseOptions(a);w.value=l.data.brand,d.value=l.data.product}catch(a){console.error("Error fetching filter options:",a)}};return(o,a)=>ae((F(),q("div",{ref_key:"container",ref:_,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:le(`grid-template-columns: repeat(${S.value}, 1fr)`)},[c("div",null,[i(M,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value=l),options:d.value,onShow:a[1]||(a[1]=l=>A("product")),controls:"",label:"Produk",placeholder:"Pilih Produk","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),c("div",null,[i(M,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=l=>u.value=l),options:w.value,onShow:a[3]||(a[3]=l=>A("brand")),controls:"",label:"Brand",placeholder:"Pilih Brand","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),c("div",null,[i(M,{modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=l=>m.value=l),options:g.value,onShow:a[5]||(a[5]=l=>A("status")),controls:"",label:"Status",placeholder:"Pilih Status","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),c("div",null,[i(J,{"model-value":v.value,"onUpdate:modelValue":a[6]||(a[6]=l=>v.value=l),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),c("div",null,[i(J,{"model-value":p.value,"onUpdate:modelValue":a[7]||(a[7]=l=>p.value=l),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),c("div",fe,[i(U,{onClick:O,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),i(U,{onClick:B,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[te,$.value]])}}),he={id:"main-view",class:"bg-[#eeedf2] w-full overflow-y-hidden"},ye={class:"flex flex-col gap-2 p-4"},ge={class:"flex flex-col gap-2 text-black"},ke={class:"flex flex-col gap-2"},we={class:"flex flex-row justify-start gap-2"},Se={class:"w-full flex justify-end gap-2"},_e={class:"w-full"},ea=L({__name:"WareHouseView",setup(E){const n=r({visible:!1,type:"add",header:"Tambah Kategori",useStay:!1}),S=ce(),u=oe(),s=r(),m=r(),w=r([]),d=r({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),g=r([]),v=P(()=>[{label:"Edit",icon:"edit",visible:V("warehouse_stock").update,command:()=>{var e;n.value={visible:!0,type:"edit",header:"Edit Toko",useStay:!1},s.value=(e=m.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:V("warehouse_stock").delete,command:()=>{g.value=[m.value],d.value={visible:!0,header:"Hapus Toko",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus toko ini?",list:g.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),p=P(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:V("warehouse_stock").delete,command:()=>{g.value=w.value,d.value={visible:!0,header:"Edit Kategori",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin mengubah kategori ini?",list:g.value.map(e=>e.name),confirmLabel:"Ubah",actionable:!0}}}]),$=[{header:"Produk",field:"product.name",sortable:!0,bodyTemplate:e=>e.product?e.product.name:"-"},{header:"Merek",field:"product.brand.name",sortable:!0,bodyTemplate:e=>{var t,b,N;return(t=e.product)!=null&&t.brand?(N=(b=e.product)==null?void 0:b.brand)==null?void 0:N.name:"-"}},{header:"Jumlah",field:"quantity",sortable:!0,bodyTemplate:e=>e.quantity!==void 0?e.quantity.toString():"-"},{header:"Status",field:"status",sortable:!0,bodyComponent:e=>{var t,b;return{component:me,props:{label:((t=B(e.status))==null?void 0:t.charAt(0).toUpperCase())+((b=B(e.status))==null?void 0:b.slice(1)),severity:x(e.status)}}}},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?G(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?G(new Date(e.createdAt)):"-"}],_=[{name:"Gudang",route:"/warehouse"}],h=P(()=>w.value.length>0),x=e=>{switch(e){case"outOfStock":return"danger";case"lowStock":return"warning";default:return"success"}},B=e=>{switch(e){case"outOfStock":return"Habis";case"lowStock":return"Stok Rendah";default:return"Tersedia"}},O=()=>{S.push("/manage-product/product-in/add")},T=e=>{n.value.type==="add"?o():n.value.type==="edit"&&a()},D=async()=>{await l(g.value.map(e=>e.id))},A=async e=>{try{const{data:t}=await R.getWarehouseStock(e);return t}catch(t){console.error("Error fetching store data:",t)}},o=async()=>{try{if(!s.value)return;await C.createStore({name:s.value}),n.value.visible=!1,s.value="",u.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah toko",life:3e3}),k.emit("data-table:update",{tableName:"table-store"})}catch(e){console.error("Error creating store:",e),u.add({severity:"error",summary:"Gagal",detail:"Gagal menambah toko",life:3e3})}},a=async()=>{try{if(!s.value||!m.value)return;await C.updateStore(m.value.id,{name:s.value}),n.value.visible=!1,s.value="",u.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah toko",life:3e3}),k.emit("data-table:update",{tableName:"table-store"})}catch(e){console.error("Error updating store:",e),u.add({severity:"error",summary:"Gagal",detail:"Gagal mengubah toko",life:3e3})}},l=async e=>{try{const t={id:e};await C.deleteStore(t),d.value.visible=!1,w.value=[],u.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus toko",life:3e3}),k.emit("data-table:update",{tableName:"table-store"})}catch(t){console.error("Error deleting store:",t),u.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus toko",life:3e3})}},f=()=>{s.value=void 0};return se(()=>n.value.visible,()=>{n.value.visible||f()},{immediate:!0}),(e,t)=>{var b,N;return F(),q(ie,null,[c("div",he,[c("div",ye,[i(W,{menus:_}),i(X,null,{default:H(()=>[c("div",ge,[c("div",ke,[c("div",we,[i(j,{options:p.value,class:re(`${h.value?"flex":"!hidden"} h-[21px] w-[120px]`)},null,8,["options","class"]),c("div",Se,[i(ve,{"table-name":"table-warehouse"}),i(pe,{"table-name":"table-warehouse"}),de(V)("warehouse_stock").create?(F(),ne(U,{key:0,onClick:O,label:"Tambah Stok",severity:"primary",class:"text-xs"})):ue("",!0)])]),i(be,{"table-name":"table-warehouse"}),i(I,{"data-key":"id","fetch-function":A,columns:$,options:v.value,onToggleOption:t[0]||(t[0]=y=>m.value=y),"onUpdate:selectedData":t[1]||(t[1]=y=>w.value=y),"table-name":"table-warehouse","selection-type":"single","use-paginator":"","use-options":!1},null,8,["options"])])])]),_:1})])]),i(z,{visible:n.value.visible,"onUpdate:visible":[t[3]||(t[3]=y=>n.value.visible=y),n.value.visible],header:(b=n.value)==null?void 0:b.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(N=n.value)==null?void 0:N.useStay,"use-close":!0,closable:!1,onSubmit:T},{default:H(()=>[c("div",_e,[i(Q,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=y=>s.value=y),label:"Nama Toko",placeholder:"Masukkan nama toko"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),i(K,{visible:d.value.visible,"onUpdate:visible":t[4]||(t[4]=y=>d.value.visible=y),onConfirm:D,header:d.value.header,"header-icon":"check",list:d.value.list,message:d.value.message,severity:d.value.severity,"confirm-button-severity":d.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64)}}});export{ea as default};
