import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as R}from"./api.service-Dgs1boU1.js";import{_ as E}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{_ as V}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{f as A,a as O}from"./data.utils-Cp1LBIu0.js";import{u as M,v,a5 as U,y as G,K as L,q as H,a6 as J,o as S,c as F,a7 as j,z as f,b as c,M as q,I as $,a4 as w,E as K,J as z,p as D,w as W,F as Q,r as X,t as Y,x as Z}from"./index-DOh3iN_U.js";import{S as P}from"./stock.service-C4NW6Gnu.js";import{_ as C}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import{e as g}from"./index-CFjhT2rJ.js";import{_ as ee,a as ae}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{_ as te}from"./Badge.vue_vue_type_script_setup_true_lang-BSKQkbi2.js";import"./auth.service-BxJEy6Ur.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";import"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";const se={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},le=M({inheritAttrs:!1,__name:"ProductInFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(I,{emit:_}){const y=v(4),i=v([]),a=v([]),u=v([]),b=U(!1),s=v(null),p=I,h=_;G(()=>{x(),g.on("show-filter",k)}),L(()=>{g.off("show-filter",k)});const T=()=>{const n={};if(g.emit("multi-select:hide-overlay"),i.value&&i.value.length>0){const l=i.value[0]?new Date(i.value[0]):null,r=i.value[1]?new Date(i.value[1]):new Date(i.value[0]),o=[l];r&&o.push(r),n.date=JSON.stringify(o)}if(a.value&&a.value.length>0){const l=a.value[0]?new Date(a.value[0]):null,r=a.value[1]?new Date(a.value[1]):new Date(a.value[0]),o=[l];r&&o.push(r),n.updatedAt=JSON.stringify(o)}if(u.value&&u.value.length>0){const l=u.value[0]?new Date(u.value[0]):null,r=u.value[1]?new Date(u.value[1]):new Date(u.value[0]),o=[l];r&&o.push(r),n.createdAt=JSON.stringify(o)}g.emit("data-table:apply-filter",{tableName:p==null?void 0:p.tableName,filter:n}),g.emit("data-table:clear-selected-data",{tableName:p==null?void 0:p.tableName}),h==null||h("apply",n)},B=()=>{i.value=[],a.value=[],u.value=[]},k=n=>{n.tableName===p.tableName&&(b.value=n.show)},x=()=>{if(s.value){const{children:n}=s.value,l=s.value.childElementCount,r=l%y.value;let[o,e]=[1,1];for(const t in Array.from({length:l})){const m=Number(t)===l-1;n[t].setAttribute("style",`grid-area: ${o}/${m&&r?y.value:e}`),++e>y.value&&(e=1,o++)}}};return(n,l)=>H((S(),F("div",{ref_key:"container",ref:s,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:j(`grid-template-columns: repeat(${y.value}, 1fr)`)},[f("div",null,[c(C,{"model-value":i.value,"onUpdate:modelValue":l[0]||(l[0]=r=>i.value=r),label:"Tanggal Transaksi",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),f("div",null,[c(C,{"model-value":a.value,"onUpdate:modelValue":l[1]||(l[1]=r=>a.value=r),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),f("div",null,[c(C,{"model-value":u.value,"onUpdate:modelValue":l[2]||(l[2]=r=>u.value=r),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),f("div",se,[c(N,{onClick:B,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),c(N,{onClick:T,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[J,b.value]])}}),re={class:"flex flex-col gap-2 text-black"},ie={class:"flex flex-col gap-2"},ne={class:"flex flex-row justify-start gap-2"},oe={class:"w-full flex justify-end gap-2"},De=M({__name:"ProductInView",setup(I){const _=K(),y=z(),i=q(),a=v(),u=v([]),b=v([]),s=v({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),p=e=>{switch(e){case"completed":return"Selesai";default:return"Pending"}},h=e=>{switch(e){case"completed":return"success";default:return"warning"}},T=$(()=>{var e,t,m;return[{label:"Edit",icon:"edit",visible:((e=a==null?void 0:a.value)==null?void 0:e.status)!=="completed"&&w("product_in").update,command:()=>{var d;sessionStorage.setItem("productIn",String((d=a.value)==null?void 0:d.id)),_.push("/manage-product/product-in/edit")}},{label:"Tandai Selesai",icon:"check",visible:((t=a==null?void 0:a.value)==null?void 0:t.status)!=="completed"&&w("product_in").update,command:()=>{b.value=[a.value],s.value={visible:!0,header:"Tandai Barang Masuk Selesai",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menandai barang masuk ini sebagai selesai?",list:b.value.map(d=>d.transactionCode),confirmLabel:"Tandai Selesai",actionable:!0}}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:((m=a==null?void 0:a.value)==null?void 0:m.status)!=="completed"&&w("product_in").delete,command:()=>{b.value=[a.value],s.value={visible:!0,header:"Hapus Barang Masuk",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus barang masuk ini?",list:b.value.map(d=>d.transactionCode),confirmLabel:"Hapus",actionable:!0}}}]}),B=[{header:"Kode Transaksi",field:"transactionCode",sortable:!0},{header:"Tanggal Transaksi",field:"date",sortable:!0,bodyTemplate:e=>e.date?A(new Date(e.date)):"-"},{header:"Status",field:"status",sortable:!0,bodyComponent:e=>({component:te,props:{label:p(e.status),severity:h(e.status)}})},{header:"Barang",field:"product.name",sortable:!0,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(m=>({value:`${m.name}`}))}}},{header:"Qty",field:"product.quantity",sortable:!0,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(m=>({value:`${m.quantity}`}))}}},{header:"Masuk Ke",field:"toStore.name",sortable:!0,bodyTemplate:e=>e.toWarehouse!==null?O(e.toWarehouse,e.toStore):"-"},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?A(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?A(new Date(e.createdAt)):"-"},{field:"user.name",header:"Dibuat Oleh",sortable:!0,bodyTemplate:e=>e.user?e.user.name:"-"}],k=$(()=>y.path.split("/").pop()),x=()=>{_.push("/manage-product/product-in/add")},n=async()=>{s.value.header==="Tandai Barang Masuk Selesai"?await r():s.value.header==="Hapus Barang Masuk"&&await o()},l=async e=>{try{const{data:t}=await P.getStockIn(e);return t}catch(t){console.error("Error fetching data:",t)}},r=async()=>{try{if(a.value===void 0){i.add({severity:"warn",summary:"Peringatan",detail:"Tidak ada barang masuk yang dipilih untuk diverifikasi.",life:3e3});return}await P.patchStockIn(a==null?void 0:a.value.id),i.add({severity:"success",summary:"Berhasil",detail:"Barang masuk berhasil diverifikasi.",life:3e3}),s.value.visible=!1,g.emit("data-table:update",{tableName:"table-product-in"})}catch(e){console.error("Error verifying product in:",e),i.add({severity:"error",summary:"Gagal",detail:"Gagal memverifikasi barang masuk.",life:3e3})}},o=async()=>{var e;try{if(a.value===void 0){i.add({severity:"warn",summary:"Peringatan",detail:"Tidak ada barang masuk yang dipilih untuk dihapus.",life:3e3});return}await P.deleteStockIn((e=a==null?void 0:a.value)==null?void 0:e.id),i.add({severity:"success",summary:"Berhasil",detail:"Barang masuk berhasil dihapus.",life:3e3}),s.value.visible=!1,g.emit("data-table:update",{tableName:"table-product-in"})}catch(t){console.error("Error deleting product in:",t),i.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus barang masuk.",life:3e3})}};return(e,t)=>{const m=X("router-view");return k.value==="add"||k.value==="edit"?(S(),D(m,{key:0})):(S(),F(Q,{key:1},[c(R,null,{default:W(()=>[f("div",re,[f("div",ie,[f("div",ne,[f("div",oe,[c(ee,{"table-name":"table-product-in"}),c(ae,{"table-name":"table-product-in"}),Z(w)("product_in").create?(S(),D(N,{key:0,onClick:x,label:"Tambah Barang Masuk",severity:"primary",class:"text-xs"})):Y("",!0)])]),c(le,{"table-name":"table-product-in"}),c(E,{"data-key":"id","fetch-function":l,columns:B,options:T.value,"use-options":"",onToggleOption:t[0]||(t[0]=d=>a.value=d),"onUpdate:selectedData":t[1]||(t[1]=d=>u.value=d),"table-name":"table-product-in","selection-type":"single","use-paginator":""},null,8,["options"])])])]),_:1}),c(V,{visible:s.value.visible,"onUpdate:visible":t[2]||(t[2]=d=>s.value.visible=d),onConfirm:n,header:s.value.header,"header-icon":"check",list:s.value.list,message:s.value.message,severity:s.value.severity,"confirm-button-severity":s.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64))}}});export{De as default};
