import{_ as R}from"./Badge.vue_vue_type_script_setup_true_lang-Dl20FNV1.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-DGQVTf0o.js";import{_ as U}from"./Card.vue_vue_type_script_setup_true_lang-DX6ZCcCT.js";import{_ as L}from"./DataTable.vue_vue_type_script_setup_true_lang-DoVQSg4o.js";import{S as B}from"./stock.service-Bv_KP4HN.js";import{S as q}from"./store.service-C-ieJN3b.js";import{f as T}from"./data.utils-eGwCzW_2.js";import{u as C,v as u,a5 as j,E as I,L as z,q as H,a6 as G,o as $,c as K,y as r,b as d,a7 as Q,N as W,p as V,w as X,z as Y,t as Z,x as ee,K as te,D as ae}from"./index-DqykKEQs.js";import{_ as oe,a as le}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-BJjdtVBm.js";import{_ as P}from"./DatePicker.vue_vue_type_script_setup_true_lang-BqywHS1T.js";import{e as g}from"./index-CFjhT2rJ.js";import{_ as x}from"./MultiSelect.vue_vue_type_script_setup_true_lang-B7FtPCEv.js";import"./Icon.vue_vue_type_script_setup_true_lang-BkCxuF7w.js";import"./Animation-DocTEj0o.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BTAk6bev.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-nl87V-r_.js";import"./index-DAvpFy_L.js";import"./index-CGyeo5Ur.js";import"./index-4Z3wIbdd.js";import"./api.service-BxyLpYlp.js";import"./index-MGwmnnen.js";import"./InputText.vue_vue_type_script_setup_true_lang-B5UaJIzA.js";import"./index-Dykrzcub.js";import"./index-COjWZHG3.js";import"./index-8s4L6CXK.js";const se={class:"!overflow-hidden"},re={class:"!overflow-hidden"},ne={class:"!overflow-hidden"},ie={class:"!overflow-hidden"},ue={class:"!overflow-hidden"},de={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},ce=C({inheritAttrs:!1,__name:"StoreStockFilterFields",props:{id:{},tableName:{default:"product-table"}},emits:["apply"],setup(A,{emit:_}){const v=u(4),c=u(),m=u(),p=u(),y=u([]),h=u([]),S=u([{label:"Aktif",value:"active"},{label:"Tidak Aktif",value:"inactive"}]),n=u([]),i=u([]),e=j(!1),l=u(null),o=A,b=_;I(()=>{E(),g.on("show-filter",D)}),z(()=>{g.off("show-filter",D)});const F=()=>{const s={};if(g.emit("multi-select:hide-overlay"),c.value&&c.value.length>0&&(s.brand=JSON.stringify(c.value)),m.value&&m.value.length>0&&(s.product=JSON.stringify(m.value)),p.value&&p.value.length>0&&(s.status=JSON.stringify(p.value)),n.value&&n.value.length>0){const t=n.value[0]?new Date(n.value[0]):null,a=n.value[1]?new Date(n.value[1]):new Date(n.value[0]),f=[t];a&&f.push(a),s.updatedAt=JSON.stringify(f)}if(i.value&&i.value.length>0){const t=i.value[0]?new Date(i.value[0]):null,a=i.value[1]?new Date(i.value[1]):new Date(i.value[0]),f=[t];a&&f.push(a),s.createdAt=JSON.stringify(f)}g.emit("data-table:apply-filter",{tableName:o==null?void 0:o.tableName,filter:s}),g.emit("data-table:clear-selected-data",{tableName:o==null?void 0:o.tableName}),b==null||b("apply",s)},J=()=>{c.value=[],m.value=[],p.value=[],n.value=[],i.value=[]},D=s=>{s.tableName===o.tableName&&(e.value=s.show)},E=()=>{if(l.value){const{children:s}=l.value,t=l.value.childElementCount,a=t%v.value;let[f,w]=[1,1];for(const O in Array.from({length:t})){const M=Number(O)===t-1;s[O].setAttribute("style",`grid-area: ${f}/${M&&a?v.value:w}`),++w>v.value&&(w=1,f++)}}},k=async s=>{try{let t={};s==="brand"&&(t.brand=JSON.stringify(!0)),s==="product"&&(t.product=JSON.stringify(!0)),s==="status"&&(S.value=[{label:"Tersedia",value:"available"},{label:"Stok Rendah",value:"lowStock"},{label:"Habis",value:"outOfStock"}]);const{data:a}=await B.getStoreStockOptionsById(o==null?void 0:o.id,t);s==="brand"&&(y.value=a.data.brand),s==="product"&&(h.value=a.data.product)}catch(t){console.error("Error fetching filter options:",t)}};return(s,t)=>H(($(),K("div",{ref_key:"container",ref:l,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3 overflow-x-scroll",style:Q(`grid-template-columns: repeat(${v.value}, 1fr)`)},[r("div",se,[d(x,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=a=>m.value=a),options:h.value,onShow:t[1]||(t[1]=a=>k("product")),controls:"",label:"Produk",placeholder:"Pilih Produk","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),r("div",re,[d(x,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=a=>c.value=a),options:y.value,onShow:t[3]||(t[3]=a=>k("brand")),controls:"",label:"Brand",placeholder:"Pilih Brand","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),r("div",ne,[d(x,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=a=>p.value=a),options:S.value,onShow:t[5]||(t[5]=a=>k("status")),controls:"",label:"Status",placeholder:"Pilih Status","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),r("div",ie,[d(P,{"model-value":n.value,"onUpdate:modelValue":t[6]||(t[6]=a=>n.value=a),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),r("div",ue,[d(P,{"model-value":i.value,"onUpdate:modelValue":t[7]||(t[7]=a=>i.value=a),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),r("div",de,[d(N,{onClick:J,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),d(N,{onClick:F,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[G,e.value]])}}),me={class:"flex flex-col gap-3 text-black"},pe={class:"flex flex-row gap-1 w-fit"},fe={class:"text-sm text-center"},ve={class:"flex flex-col gap-2"},be={class:"flex flex-row justify-start gap-2"},he={class:"w-full flex justify-end gap-2"},je=C({__name:"StoreStockView",setup(A){I(()=>{n()});const _=ae(),v=W(),c=u(),m=u(),p=[{field:"product.name",header:"Nama Produk",sortable:!0},{field:"product.brand.name",header:"Merek",sortable:!0,bodyTemplate:e=>{var l,o,b;return(l=e.product)!=null&&l.brand?(b=(o=e.product)==null?void 0:o.brand)==null?void 0:b.name:"-"}},{field:"quantity",header:"Jumlah Stok",sortable:!0,bodyTemplate:e=>e.quantity!==void 0?e.quantity.toLocaleString():"-"},{field:"status",header:"Status",sortable:!0,bodyComponent:e=>{var l,o;return{component:R,props:{label:((l=h(e.status))==null?void 0:l.charAt(0).toUpperCase())+((o=h(e.status))==null?void 0:o.slice(1)),severity:y(e.status)}}}},{field:"updatedAt",header:"Terakhir Diubah",sortable:!0,bodyTemplate:e=>e.updatedAt?T(new Date(e.updatedAt)):"-"},{field:"createdAt",header:"Tanggal Dibuat",sortable:!0,bodyTemplate:e=>e.createdAt?T(new Date(e.createdAt)):"-"}],y=e=>{switch(e){case"outOfStock":return"danger";case"lowStock":return"warning";default:return"success"}},h=e=>{switch(e){case"outOfStock":return"Habis";case"lowStock":return"Stok Rendah";default:return"Tersedia"}},S=()=>{_.push("/manage-product/product-in/add")},n=async()=>{try{const e=sessionStorage.getItem("store");if(!e){console.error("Store ID not found in session storage");return}m.value=Number(e);const{data:l}=await q.getStoreById(Number(e));c.value=l.data}catch(e){console.error("Error fetching store:",e)}},i=async e=>{try{const l=sessionStorage.getItem("store");if(!l){v.add({severity:"error",summary:"Error",detail:"Store ID not found in session storage",life:3e3});return}const{data:o}=await B.getStoreStockList(e,Number(l));return o}catch(l){console.error("Error fetching store stock:",l)}};return(e,l)=>($(),V(U,null,{default:X(()=>{var o;return[r("div",me,[r("div",pe,[l[0]||(l[0]=r("span",{class:"text-sm font-semibold"},"Daftar Stok Pada: ",-1)),r("span",fe,Y((o=c.value)==null?void 0:o.name),1)]),r("div",ve,[r("div",be,[r("div",he,[d(oe,{"table-name":"table-store-stock"}),d(le,{"table-name":"table-store-stock"}),ee(te)("product_in").create?($(),V(N,{key:0,onClick:S,label:"Tambah Stock",severity:"primary",class:"text-xs"})):Z("",!0)])]),d(ce,{"table-name":"table-store-stock",id:m.value},null,8,["id"]),d(L,{"data-key":"id","fetch-function":i,columns:p,"use-options":!1,"table-name":"table-store-stock","selection-type":"single","use-paginator":""})])])]}),_:1}))}});export{je as default};
