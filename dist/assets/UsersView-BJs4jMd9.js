import{_ as V}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{U as N}from"./user.service-o5zC87Vg.js";import{f as P}from"./data.utils-Cp1LBIu0.js";import{_ as $}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as E}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Cvyx0ufE.js";import{_ as M}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{u as T,v as u,a5 as H,y as I,K as J,q as L,a6 as j,o as k,c as R,a7 as z,z as p,b as o,M as G,I as w,a4 as y,E as q,J as K,p as B,w as W,F as Q,r as X,D as Y,t as Z,x as ee}from"./index-DOh3iN_U.js";import{_ as te}from"./api.service-Dgs1boU1.js";import{e as g}from"./index-CFjhT2rJ.js";import{_ as F}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import{_ as ae}from"./MultiSelect.vue_vue_type_script_setup_true_lang-kuuDsZfP.js";import{_ as se,a as le}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./auth.service-BxJEy6Ur.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";import"./index-QsIXXSH_.js";import"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";const ie={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},oe=T({inheritAttrs:!1,__name:"UserFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(U,{emit:x}){const m=u(4),n=u(),v=u([]),s=u([]),a=u([]),i=H(!1),f=u(null),d=U,b=x;I(()=>{A(),g.on("show-filter",_)}),J(()=>{g.off("show-filter",_)});const D=()=>{const l={};if(g.emit("multi-select:hide-overlay"),n.value&&n.value.length>0&&(l.role=JSON.stringify(n.value)),s.value&&s.value.length>0){const e=s.value[0]?new Date(s.value[0]):null,t=s.value[1]?new Date(s.value[1]):new Date(s.value[0]),r=[e];t&&r.push(t),l.updatedAt=JSON.stringify(r)}if(a.value&&a.value.length>0){const e=a.value[0]?new Date(a.value[0]):null,t=a.value[1]?new Date(a.value[1]):new Date(a.value[0]),r=[e];t&&r.push(t),l.createdAt=JSON.stringify(r)}g.emit("data-table:apply-filter",{tableName:d==null?void 0:d.tableName,filter:l}),g.emit("data-table:clear-selected-data",{tableName:d==null?void 0:d.tableName}),b==null||b("apply",l)},h=()=>{n.value=[],s.value=[],a.value=[]},_=l=>{l.tableName===d.tableName&&(i.value=l.show)},A=()=>{if(f.value){const{children:l}=f.value,e=f.value.childElementCount,t=e%m.value;let[r,c]=[1,1];for(const C in Array.from({length:e})){const O=Number(C)===e-1;l[C].setAttribute("style",`grid-area: ${r}/${O&&t?m.value:c}`),++c>m.value&&(c=1,r++)}}},S=async l=>{try{let e={};l==="role"&&(e.role=JSON.stringify(!0));const{data:t}=await N.getUserOptions(e);v.value=t.data.role}catch(e){console.error("Error fetching filter options:",e)}};return(l,e)=>L((k(),R("div",{ref_key:"container",ref:f,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:z(`grid-template-columns: repeat(${m.value}, 1fr)`)},[p("div",null,[o(ae,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),options:v.value,onShow:e[1]||(e[1]=t=>S("role")),controls:"",label:"Role",placeholder:"Pilih Role","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),p("div",null,[o(F,{"model-value":s.value,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value=t),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),p("div",null,[o(F,{"model-value":a.value,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value=t),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),p("div",ie,[o($,{onClick:h,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),o($,{onClick:D,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[j,i.value]])}}),ne={class:"flex flex-col gap-2 text-black"},re={class:"flex flex-col gap-2"},ue={class:"flex flex-row justify-start gap-2"},de={class:"w-full flex justify-end gap-2"},Ve=T({__name:"UsersView",setup(U){const x=K(),m=q(),n=G(),v=u(),s=u([]),a=u([]),i=u({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),f=w(()=>[{label:"Detail",icon:"file-info",visible:y("setting_user").view,command:()=>{var e;sessionStorage.setItem("users",String((e=v.value)==null?void 0:e.id)),m.push("/settings/users/detail")}},{label:"Edit",icon:"edit",visible:y("setting_user").update,command:()=>{var e;sessionStorage.setItem("users",String((e=v.value)==null?void 0:e.id)),m.push("/settings/users/edit")}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:y("setting_user").delete,command:()=>{a.value=[v.value],i.value={visible:!0,header:"Hapus Pengguna",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus pengguna ini?",list:a.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),d=w(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:y("setting_user").delete,command:()=>{a.value=s.value,i.value={visible:!0,header:"Hapus Pengguna",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin mengubah pengguna ini?",list:a.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),b=[{header:"Username",field:"username",sortable:!0},{header:"Nama",field:"name",sortable:!0},{header:"Role",field:"roles.name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?P(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?P(new Date(e.createdAt)):"-"}],D=w(()=>s.value.length>0),h=w(()=>x.path.split("/").pop()),_=()=>{m.push("/settings/users/add")},A=async()=>{await l(a.value.map(e=>e.id))},S=async e=>{try{const{data:t}=await N.getUserList(e);return t}catch(t){console.error("Error fetching data:",t)}},l=async e=>{try{if(e.length===0){n.add({severity:"warn",summary:"Warning",detail:"Tidak ada pengguna yang dipilih untuk dihapus",life:3e3});return}const t={id:e};await N.deleteUser(t),n.add({severity:"success",summary:"Success",detail:"Pengguna berhasil dihapus",life:3e3}),i.value.visible=!1,s.value=[],g.emit("data-table:update",{tableName:"table-user"})}catch(t){console.error("Error deleting user:",t),n.add({severity:"error",summary:"Error",detail:"Gagal menghapus pengguna",life:3e3})}};return(e,t)=>{const r=X("router-view");return h.value==="add"||h.value==="edit"||h.value==="detail"?(k(),B(r,{key:0})):(k(),R(Q,{key:1},[o(te,null,{default:W(()=>[p("div",ne,[p("div",re,[p("div",ue,[o(E,{options:d.value,class:Y(`${D.value?"flex":"!hidden"} h-[21px] w-[120px]`)},null,8,["options","class"]),p("div",de,[o(se,{"table-name":"table-user"}),o(le,{"table-name":"table-user"}),ee(y)("setting_user").create?(k(),B($,{key:0,onClick:_,label:"Tambah Pengguna",severity:"primary",class:"text-xs"})):Z("",!0)])]),o(oe,{"table-name":"table-user"}),o(V,{"data-key":"id","fetch-function":S,columns:b,options:f.value,onToggleOption:t[0]||(t[0]=c=>v.value=c),"onUpdate:selectedData":t[1]||(t[1]=c=>s.value=c),"table-name":"table-user","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),o(M,{visible:i.value.visible,"onUpdate:visible":t[2]||(t[2]=c=>i.value.visible=c),onConfirm:A,header:i.value.header,"header-icon":"check",list:i.value.list,message:i.value.message,severity:i.value.severity,"confirm-button-severity":i.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64))}}});export{Ve as default};
