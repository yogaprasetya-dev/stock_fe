import{_ as O}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{U as x}from"./unit.service-Ck8PLPrx.js";import{_ as I}from"./Dialog.vue_vue_type_script_setup_true_lang-BwIWKMFo.js";import{_ as J}from"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import{e as y}from"./index-CFjhT2rJ.js";import{_ as $}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{f as F}from"./data.utils-Cp1LBIu0.js";import{_ as L}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{_ as H}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Cvyx0ufE.js";import{_ as R}from"./api.service-Dgs1boU1.js";import{_ as j,a as q}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{u as P,v as u,a5 as z,y as K,K as Q,q as W,a6 as X,o as C,c as G,a7 as Y,z as h,b as r,M as Z,I as B,a4 as U,L as ee,w as E,F as ae,D as te,p as le,t as ie,x as se}from"./index-DOh3iN_U.js";import{_ as V}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./auth.service-BxJEy6Ur.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";const ne={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},oe=P({inheritAttrs:!1,__name:"UnitFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(M,{emit:i}){const c=u(4),d=u(),m=u(),b=u(),l=u([]),t=u([]),w=z(!1),g=u(null),f=M,_=i;K(()=>{N(),y.on("show-filter",k)}),Q(()=>{y.off("show-filter",k)});const A=()=>{const s={};if(y.emit("multi-select:hide-overlay"),d.value&&d.value.length>0&&(s.brand=JSON.stringify(d.value)),m.value&&m.value.length>0&&(s.category=JSON.stringify(m.value)),b.value&&b.value.length>0&&(s.unit=JSON.stringify(b.value)),l.value&&l.value.length>0){const n=l.value[0]?new Date(l.value[0]):null,o=l.value[1]?new Date(l.value[1]):new Date(l.value[0]),v=[n];o&&v.push(o),s.updatedAt=JSON.stringify(v)}if(t.value&&t.value.length>0){const n=t.value[0]?new Date(t.value[0]):null,o=t.value[1]?new Date(t.value[1]):new Date(t.value[0]),v=[n];o&&v.push(o),s.createdAt=JSON.stringify(v)}y.emit("data-table:apply-filter",{tableName:f==null?void 0:f.tableName,filter:s}),y.emit("data-table:clear-selected-data",{tableName:f==null?void 0:f.tableName}),_==null||_("apply",s)},D=()=>{l.value=[],t.value=[]},k=s=>{s.tableName===f.tableName&&(w.value=s.show)},N=()=>{if(g.value){const{children:s}=g.value,n=g.value.childElementCount,o=n%c.value;let[v,e]=[1,1];for(const a in Array.from({length:n})){const S=Number(a)===n-1;s[a].setAttribute("style",`grid-area: ${v}/${S&&o?c.value:e}`),++e>c.value&&(e=1,v++)}}};return(s,n)=>W((C(),G("div",{ref_key:"container",ref:g,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:Y(`grid-template-columns: repeat(${c.value}, 1fr)`)},[h("div",null,[r(V,{"model-value":l.value,"onUpdate:modelValue":n[0]||(n[0]=o=>l.value=o),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),h("div",null,[r(V,{"model-value":t.value,"onUpdate:modelValue":n[1]||(n[1]=o=>t.value=o),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),h("div",ne,[r($,{onClick:D,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),r($,{onClick:A,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[X,w.value]])}}),re={class:"flex flex-col gap-2"},ue={class:"flex flex-col gap-2"},de={class:"flex flex-row justify-start gap-2"},ce={class:"w-full flex justify-end gap-2"},me={class:"w-full"},Ge=P({__name:"UnitView",setup(M){const i=u({visible:!1,type:"add",header:"Tambah Merek"}),c=Z(),d=u(),m=u(),b=u([]),l=u([]),t=u({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),w=B(()=>[{label:"Edit",icon:"edit",visible:U("unit").update,command:()=>{var e;i.value={visible:!0,type:"edit",header:"Edit Satuan",useStay:!1},d.value=(e=m.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:U("unit").delete,command:()=>{l.value=[m.value],t.value={visible:!0,header:"Hapus Satuan",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus satuan ini?",list:l.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),g=B(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:U("unit").delete,command:()=>{l.value=b.value,t.value={visible:!0,header:"Edit Satuan",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus unit ini?",list:l.value.map(e=>e.name),confirmLabel:"Ubah",actionable:!0}}}]),f=[{header:"Satuan",field:"name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?F(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?F(new Date(e.createdAt)):"-"}],_=B(()=>b.value.length>0),A=()=>{i.value={visible:!0,type:"add",header:"Tambah Satuan"}},D=async e=>{try{const{data:a}=await x.getUnit(e);return a}catch(a){console.error("Error fetching store data:",a)}},k=e=>{i.value.type==="add"?s():i.value.type==="edit"&&n()},N=()=>{d.value=void 0},s=async()=>{try{if(!d.value){console.error("Unit name is required");return}await x.createUnit({name:d.value}),i.value.visible=!1,c.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah satuan",life:3e3}),y.emit("data-table:update",{tableName:"table-unit"})}catch(e){console.error("Error creating unit:",e),c.add({severity:"error",summary:"Gagal",detail:"Gagal menambah satuan",life:3e3})}},n=async()=>{var e;try{if(!d.value||!((e=m.value)!=null&&e.id)){console.error("Unit name and ID are required for update");return}await x.editUnit(m.value.id,{name:d.value}),i.value.visible=!1,c.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah satuan",life:3e3}),y.emit("data-table:update",{tableName:"table-unit"})}catch(a){console.error("Error updating unit:",a),c.add({severity:"error",summary:"Gagal",detail:"Gagal mengubah satuan",life:3e3})}},o=async()=>{await v(l.value.map(e=>e.id))},v=async e=>{try{const a={id:e};await x.deleteUnit(a),t.value.visible=!1,c.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus satuan",life:3e3}),m.value=void 0,b.value=[],y.emit("data-table:update",{tableName:"table-unit"})}catch(a){console.error("Error deleting unit:",a),c.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus satuan",life:3e3})}};return ee(()=>i.value.visible,()=>{i.value.visible||N()},{immediate:!0}),(e,a)=>{var S,T;return C(),G(ae,null,[r(R,null,{default:E(()=>[h("div",re,[h("div",ue,[h("div",de,[r(H,{options:g.value,class:te(`${_.value?"flex":"!hidden"} h-[21px] w-[120px]`)},null,8,["options","class"]),h("div",ce,[r(j,{"table-name":"table-unit"}),r(q,{"table-name":"table-unit"}),se(U)("unit").create?(C(),le($,{key:0,onClick:A,label:"Tambah Satuan",severity:"primary",class:"text-xs"})):ie("",!0)])]),r(oe,{"table-name":"table-unit"}),r(O,{"data-key":"id","fetch-function":D,columns:f,options:w.value,onToggleOption:a[0]||(a[0]=p=>m.value=p),"onUpdate:selectedData":a[1]||(a[1]=p=>b.value=p),"table-name":"table-unit","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),r(I,{visible:i.value.visible,"onUpdate:visible":[a[3]||(a[3]=p=>i.value.visible=p),i.value.visible],header:(S=i.value)==null?void 0:S.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(T=i.value)==null?void 0:T.useStay,"use-close":!0,closable:!1,onSubmit:k},{default:E(()=>[h("div",me,[r(J,{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=p=>d.value=p),label:"Nama Satuan",placeholder:"Masukkan nama satuan"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),r(L,{visible:t.value.visible,"onUpdate:visible":a[4]||(a[4]=p=>t.value.visible=p),onConfirm:o,header:t.value.header,"header-icon":"check",list:t.value.list,message:t.value.message,severity:t.value.severity,"confirm-button-severity":t.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64)}}});export{Ge as default};
