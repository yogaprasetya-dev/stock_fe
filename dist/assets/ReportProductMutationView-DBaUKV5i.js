import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-B8PURPzj.js";import{_ as x}from"./DataTable.vue_vue_type_script_setup_true_lang-D77y3HgS.js";import{S}from"./stock.service-FGM5fSqI.js";import{f as B}from"./data.utils-eGwCzW_2.js";import{_ as k}from"./DatePicker.vue_vue_type_script_setup_true_lang-hjH7K3e2.js";import{_ as T}from"./Icon.vue_vue_type_script_setup_true_lang-DIZdKOaf.js";import{_ as w}from"./Button.vue_vue_type_script_setup_true_lang-Dh7jfG_D.js";import{e as M}from"./index-CFjhT2rJ.js";import{E as $,a as C}from"./jspdf.plugin.autotable-BEDYlYP2.js";import{u as L,v as s,M as N,p as j,w as V,o as R,y as r,z as A,b as p}from"./index-DuqMkg4i.js";import"./Animation-DlRldYrW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BzWzbJP8.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-BKnS3hZE.js";import"./index-DSPpt8Dk.js";import"./index-CxOcdtD_.js";import"./index-BuCuFxRa.js";import"./api.service-C54YsUjA.js";import"./index-D3QVXGA5.js";import"./index-BJdiuMEp.js";import"./index-DunXWRsd.js";const E={class:"flex flex-col gap-3 text-black"},J={class:"flex flex-row gap-1 w-fit"},K={class:"text-sm text-center"},P={class:"flex flex-col gap-2 pt-2"},U={class:"flex flex-row justify-start gap-2 w-full"},q={class:"grid grid-cols-2 gap-2 w-full"},z={class:"w-full flex justify-end gap-2"},I={class:"flex items-center gap-1"},me=L({__name:"ReportProductMutationView",setup(Q){const g=s(),a=s(),m=s([]),d=s([["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang","Tujuan Barang"]]),i=s([]),b=[{field:"date",header:"Tanggal Transaksi",sortable:!1,bodyTemplate:e=>e.date?B(new Date(e.date)):"-"},{field:"product.code",header:"Kode Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(o=>({value:`${o.code}`}))}}},{field:"product.name",header:"Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(o=>({value:`${o.name}`}))}}},{field:"product.quantity",header:"Jumlah Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(o=>({value:`${o.quantity}`}))}}},{field:"fromStore",header:"Sumber Barang",sortable:!1,bodyTemplate:e=>e.fromStore?e==null?void 0:e.fromStore:"-"},{field:"toStore",header:"Tujuan Barang",sortable:!1,bodyTemplate:e=>e.toStore?e==null?void 0:e.toStore:"-"}],h=()=>{var n,u;if(!a.value)return;const e=((n=a==null?void 0:a.value)==null?void 0:n.getMonth())+1,t=(u=a==null?void 0:a.value)==null?void 0:u.getFullYear(),o={month:e,year:t};M.emit("data-table:apply-filter",{tableName:"table-report-product-mutation",filter:o})},v=()=>{const e=new $,t=a.value?a.value.toLocaleDateString("id-ID",{month:"long",year:"numeric"}):"";e.text("Laporan Barang Mutasi",105,10,{align:"center"}),e.text("Agen Sembako Mbak Endang",105,20,{align:"center"}),e.text(t,105,30,{align:"center"});let o=[];for(const l of m.value){const c=new Date(l.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});for(const f of l.products)o.push({date:c,code:f.code,productName:f.name,totalQty:0,fromStore:l.fromStore,toStore:l.toStore})}o.map((l,c)=>{i.value.push([c+1,l.date,l.code,l.productName,l.totalQty,l.fromStore,l.toStore])}),C(e,{head:d.value,body:i.value,styles:{fontSize:9},headStyles:{fillColor:[0,123,255]},margin:{top:40}});const n=e.output("blob"),u=URL.createObjectURL(n);window.open(u),i.value=[]},_=async e=>{var t;try{const{data:o}=await S.getStockMutationReport(e);return m.value=((t=o==null?void 0:o.data)==null?void 0:t.data)||[],o}catch(o){console.error("Error fetching store stock:",o)}};return N(()=>a.value,()=>{i.value=[],d.value=[["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang","Tujuan Barang"]]}),(e,t)=>(R(),j(y,null,{default:V(()=>{var o;return[r("div",E,[r("div",J,[t[1]||(t[1]=r("span",{class:"text-lg font-semibold"},"Laporan Barang Mutasi",-1)),r("span",K,A((o=g.value)==null?void 0:o.name),1)]),r("div",P,[r("div",U,[r("div",q,[r("div",null,[p(k,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=n=>a.value=n),view:"month",dateFormat:"MM yy",placeholder:"Pilih Bulan & Tahun Transaksi"},null,8,["modelValue"])]),r("div",null,[p(w,{onClick:h,label:"Terapkan",severity:"primary",class:"text-xs"})])]),r("div",z,[r("button",{onClick:v,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-500 text-white hover:bg-blue-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-blue-600"},[r("div",I,[p(T,{icon:"printer"}),t[2]||(t[2]=r("span",null,"Cetak Laporan",-1))])])])]),p(x,{"data-key":"id","fetch-function":_,columns:b,"use-options":!1,"table-name":"table-report-product-mutation","selection-type":"single","use-paginator":""})])])]}),_:1}))}});export{me as default};
