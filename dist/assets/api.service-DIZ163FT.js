import{a as p,c as h,A as u}from"./auth.service-CbCeYD79.js";import{al as A,Q as f,am as m,an as d}from"./index-CZcKsIac.js";const k=h.apiURL,r=p.create({baseURL:`${k}/api/v1/`,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(s=>{const e=A();return e&&(s.headers.Authorization=`Bearer ${e}`),s});r.interceptors.response.use(s=>s,async s=>{var t,a,o;const e=s.config,i=((t=e==null?void 0:e.url)==null?void 0:t.startsWith("/api/v1/auth/login"))||((a=e==null?void 0:e.url)==null?void 0:a.startsWith("/api/v1/auth/refresh"));if(((o=s.response)==null?void 0:o.status)===401&&!e._retry&&!i){e._retry=!0;try{const c=(await u.refresh()).data.data.accessToken;return f(c),e.headers.Authorization=`Bearer ${c}`,r(e)}catch(n){return m(),d.push("/auth/login"),Promise.reject(n)}}return Promise.reject(s)});export{r as A};
