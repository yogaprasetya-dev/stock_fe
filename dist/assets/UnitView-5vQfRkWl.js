import{_ as P}from"./DataTable.vue_vue_type_script_setup_true_lang-sOjexovF.js";import{U as x}from"./unit.service-OZB2sru2.js";import{_ as H}from"./Dialog.vue_vue_type_script_setup_true_lang-C4SwWx6D.js";import{_ as J}from"./InputText.vue_vue_type_script_setup_true_lang-OxSdNUG8.js";import{e as _}from"./index-CFjhT2rJ.js";import{_ as $}from"./Button.vue_vue_type_script_setup_true_lang-2TrklThR.js";import{f as F}from"./data.utils-eGwCzW_2.js";import{_ as L}from"./DialogConfirm.vue_vue_type_style_index_0_lang-C5_82pQK.js";import{_ as R}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-BLDh6UOK.js";import{_ as W}from"./Card.vue_vue_type_script_setup_true_lang-BOCibx2r.js";import{_ as j,a as I}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-Db7FYHWh.js";import{u as G,v as u,a6 as q,G as z,M as K,q as Q,a7 as X,o as T,c as O,a8 as Y,y as w,b as v,O as Z,J as M,L as A,N as ee,w as V,F as ae,p as te,t as le,x as ie}from"./index-BGhEJGBM.js";import{_ as E}from"./DatePicker.vue_vue_type_script_setup_true_lang-CUP7g0mX.js";import"./Icon.vue_vue_type_script_setup_true_lang-CaTtpYxS.js";import"./Animation-D7axXRzZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BJx-ahA-.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DYbcOFbB.js";import"./index-vx55ZWHK.js";import"./index-BweVj9b9.js";import"./index-BeR49MAt.js";import"./api.service-Cu4WKU11.js";import"./index-MGwmnnen.js";import"./index-C6Gu924b.js";import"./index-C0mE0xBy.js";import"./index-B3Anr8dw.js";const se={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},ne=G({inheritAttrs:!1,__name:"UnitFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(C,{emit:t}){const i=u(4),n=u(),b=u(),g=u(),l=u([]),d=u([]),m=q(!1),k=u(null),h=C,S=t;z(()=>{B(),_.on("show-filter",N)}),K(()=>{_.off("show-filter",N)});const D=()=>{const s={};if(_.emit("multi-select:hide-overlay"),n.value&&n.value.length>0&&(s.brand=JSON.stringify(n.value)),b.value&&b.value.length>0&&(s.category=JSON.stringify(b.value)),g.value&&g.value.length>0&&(s.unit=JSON.stringify(g.value)),l.value&&l.value.length>0){const r=l.value[0]?new Date(l.value[0]):null,c=l.value[1]?new Date(l.value[1]):new Date(l.value[0]),y=[r];c&&y.push(c),s.updatedAt=JSON.stringify(y)}if(d.value&&d.value.length>0){const r=d.value[0]?new Date(d.value[0]):null,c=d.value[1]?new Date(d.value[1]):new Date(d.value[0]),y=[r];c&&y.push(c),s.createdAt=JSON.stringify(y)}_.emit("data-table:apply-filter",{tableName:h==null?void 0:h.tableName,filter:s}),_.emit("data-table:clear-selected-data",{tableName:h==null?void 0:h.tableName}),S==null||S("apply",s)},U=()=>{l.value=[],d.value=[]},N=s=>{s.tableName===h.tableName&&(m.value=s.show)},B=()=>{if(k.value){const{children:s}=k.value,r=k.value.childElementCount,c=r%i.value;let[y,e]=[1,1];for(const a in Array.from({length:r})){const o=Number(a)===r-1;s[a].setAttribute("style",`grid-area: ${y}/${o&&c?i.value:e}`),++e>i.value&&(e=1,y++)}}};return(s,r)=>Q((T(),O("div",{ref_key:"container",ref:k,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:Y(`grid-template-columns: repeat(${i.value}, 1fr)`)},[w("div",null,[v(E,{"model-value":l.value,"onUpdate:modelValue":r[0]||(r[0]=c=>l.value=c),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),w("div",null,[v(E,{"model-value":d.value,"onUpdate:modelValue":r[1]||(r[1]=c=>d.value=c),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),w("div",se,[v($,{onClick:U,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),v($,{onClick:D,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[X,m.value]])}}),re={class:"flex flex-col gap-2"},oe={class:"flex flex-col gap-2"},ue={class:"flex flex-row justify-start gap-2"},de={class:"w-full flex justify-end gap-2"},me={class:"w-full"},Oe=G({__name:"UnitView",setup(C){const t=u({visible:!1,type:"add",header:"Tambah Merek"}),i=Z(),n=u(),b=u(),g=u([]),l=u([]),d=u(!1),m=u({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),k=M(()=>[{label:"Edit",icon:"edit",visible:A("unit").update,command:()=>{var e;t.value={visible:!0,type:"edit",header:"Edit Satuan",useStay:!1},n.value=(e=b.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:A("unit").delete,command:()=>{l.value=[b.value],m.value={visible:!0,header:"Hapus Satuan",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus satuan ini?",list:l.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),h=M(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:A("unit").delete,command:()=>{l.value=g.value,m.value={visible:!0,header:"Hapus Satuan",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus unit ini?",list:l.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),S=[{header:"Satuan",field:"name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?F(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?F(new Date(e.createdAt)):"-"}],D=()=>{t.value={visible:!0,type:"add",header:"Tambah Satuan"}},U=async e=>{try{const{data:a}=await x.getUnit(e);return a}catch(a){console.error("Error fetching store data:",a)}},N=e=>{t.value.type==="add"?(d.value=(e==null?void 0:e.stay)??!1,s()):t.value.type==="edit"&&r()},B=()=>{n.value=void 0},s=async()=>{var e,a;try{if(!n.value){i.add({severity:"warn",summary:"Warning",detail:"Nama satuan harus diisi",life:3e3});return}if(n.value.length>25){i.add({severity:"warn",summary:"Warning",detail:"Nama satuan harus kurang dari 25 karakter",life:3e3});return}await x.createUnit({name:n.value}),d.value?t.value.visible=!0:t.value.visible=!1,i.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah satuan",life:3e3}),_.emit("data-table:update",{tableName:"table-unit"})}catch(o){console.error("Error creating unit:",o),i.add({severity:"error",summary:"Gagal",detail:o?(a=(e=o.response)==null?void 0:e.data)==null?void 0:a.message:"Gagal menambah satuan",life:3e3})}},r=async()=>{var e,a,o;try{if(!n.value||!((e=b.value)!=null&&e.id)){i.add({severity:"error",summary:"Warning",detail:"Nama satuan harus diisi",life:3e3});return}if(n.value.length>25){i.add({severity:"error",summary:"Warning",detail:"Nama satuan harus kurang dari 25 karakter",life:3e3});return}await x.editUnit(b.value.id,{name:n.value}),t.value.visible=!1,i.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah satuan",life:3e3}),_.emit("data-table:update",{tableName:"table-unit"})}catch(f){console.error("Error updating unit:",f),i.add({severity:"error",summary:"Gagal",detail:f?(o=(a=f.response)==null?void 0:a.data)==null?void 0:o.message:"Gagal mengubah satuan",life:3e3})}},c=async()=>{await y(l.value.map(e=>e.id))},y=async e=>{var a,o;try{const f={id:e};await x.deleteUnit(f),m.value.visible=!1,i.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus satuan",life:3e3}),b.value=void 0,g.value=[],_.emit("data-table:update",{tableName:"table-unit"})}catch(f){console.error("Error deleting unit:",f),i.add({severity:"error",summary:"Gagal",detail:f?(o=(a=f.response)==null?void 0:a.data)==null?void 0:o.message:"Gagal menghapus satuan",life:3e3})}};return ee(()=>t.value.visible,()=>{t.value.visible||B()},{immediate:!0}),(e,a)=>{var o,f;return T(),O(ae,null,[v(W,null,{default:V(()=>[w("div",re,[w("div",oe,[w("div",ue,[v(R,{"selected-data":g.value,"onUpdate:selectedData":a[0]||(a[0]=p=>g.value=p),options:h.value,"table-name":"table-unit"},null,8,["selected-data","options"]),w("div",de,[v(j,{"table-name":"table-unit"}),v(I,{"table-name":"table-unit"}),ie(A)("unit").create?(T(),te($,{key:0,onClick:D,label:"Tambah Satuan",severity:"primary",class:"text-xs"})):le("",!0)])]),v(ne,{"table-name":"table-unit"}),v(P,{"data-key":"id","fetch-function":U,columns:S,options:k.value,onToggleOption:a[1]||(a[1]=p=>b.value=p),"onUpdate:selectedData":a[2]||(a[2]=p=>g.value=p),"table-name":"table-unit","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),v(H,{visible:t.value.visible,"onUpdate:visible":[a[4]||(a[4]=p=>t.value.visible=p),t.value.visible],header:(o=t.value)==null?void 0:o.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(f=t.value)==null?void 0:f.useStay,"use-close":!0,closable:!1,onSubmit:N},{default:V(()=>[w("div",me,[v(J,{modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=p=>n.value=p),label:"Nama Satuan",placeholder:"Masukkan nama satuan"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),v(L,{visible:m.value.visible,"onUpdate:visible":a[5]||(a[5]=p=>m.value.visible=p),onConfirm:c,header:m.value.header,"header-icon":"check",list:m.value.list,message:m.value.message,severity:m.value.severity,"confirm-button-severity":m.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64)}}});export{Oe as default};
