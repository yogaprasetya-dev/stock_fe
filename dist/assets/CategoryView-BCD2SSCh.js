import{_ as O}from"./DataTable.vue_vue_type_script_setup_true_lang-C2PUkXXD.js";import{C}from"./category.service-BojmgQ-x.js";import{_ as P}from"./InputText.vue_vue_type_script_setup_true_lang-BJxyKWA0.js";import{_ as H}from"./Dialog.vue_vue_type_script_setup_true_lang-BN1hWhK0.js";import{e as h}from"./index-CFjhT2rJ.js";import{_ as J}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-DBJ07Wos.js";import{_ as W}from"./DialogConfirm.vue_vue_type_style_index_0_lang-DstnKApB.js";import{f as K}from"./data.utils-eGwCzW_2.js";import{_ as $}from"./Button.vue_vue_type_script_setup_true_lang-VLEnctj-.js";import{_ as L}from"./Card.vue_vue_type_script_setup_true_lang-DrCnTswZ.js";import{_ as R,a as j}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-CMYVQRme.js";import{u as E,v as c,a6 as I,G as q,M as z,q as Q,a7 as X,o as T,c as G,a8 as Y,y as k,b as g,O as Z,J as M,L as N,N as ee,w as U,F as ae,p as te,t as le,x as ie}from"./index-DCDvUKXo.js";import{_ as V}from"./DatePicker.vue_vue_type_script_setup_true_lang-DALjuQLu.js";import"./Icon.vue_vue_type_script_setup_true_lang-Bj9qPpRn.js";import"./Animation-CkCU4_75.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-B9YpqYCd.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-W1x2WogQ.js";import"./index-DEeMGGCH.js";import"./index-DrEEKm_D.js";import"./index-ddyPgsAF.js";import"./api.service-DQTyQFCJ.js";import"./index-D3QVXGA5.js";import"./index-CAfW60JH.js";import"./index-Cb8PJ9gJ.js";import"./index-2hWser6o.js";const re={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},se=E({inheritAttrs:!1,__name:"CategoryFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(F,{emit:l}){const i=c(4),s=c(),m=c(),n=c(),t=c([]),r=c([]),w=I(!1),_=c(null),b=F,x=l;q(()=>{B(),h.on("show-filter",S)}),z(()=>{h.off("show-filter",S)});const A=()=>{const o={};if(h.emit("multi-select:hide-overlay"),s.value&&s.value.length>0&&(o.brand=JSON.stringify(s.value)),m.value&&m.value.length>0&&(o.category=JSON.stringify(m.value)),n.value&&n.value.length>0&&(o.unit=JSON.stringify(n.value)),t.value&&t.value.length>0){const u=t.value[0]?new Date(t.value[0]):null,v=t.value[1]?new Date(t.value[1]):new Date(t.value[0]),p=[u];v&&p.push(v),o.updatedAt=JSON.stringify(p)}if(r.value&&r.value.length>0){const u=r.value[0]?new Date(r.value[0]):null,v=r.value[1]?new Date(r.value[1]):new Date(r.value[0]),p=[u];v&&p.push(v),o.createdAt=JSON.stringify(p)}h.emit("data-table:apply-filter",{tableName:b==null?void 0:b.tableName,filter:o}),h.emit("data-table:clear-selected-data",{tableName:b==null?void 0:b.tableName}),x==null||x("apply",o)},D=()=>{t.value=[],r.value=[]},S=o=>{o.tableName===b.tableName&&(w.value=o.show)},B=()=>{if(_.value){const{children:o}=_.value,u=_.value.childElementCount,v=u%i.value;let[p,e]=[1,1];for(const a in Array.from({length:u})){const d=Number(a)===u-1;o[a].setAttribute("style",`grid-area: ${p}/${d&&v?i.value:e}`),++e>i.value&&(e=1,p++)}}};return(o,u)=>Q((T(),G("div",{ref_key:"container",ref:_,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:Y(`grid-template-columns: repeat(${i.value}, 1fr)`)},[k("div",null,[g(V,{"model-value":t.value,"onUpdate:modelValue":u[0]||(u[0]=v=>t.value=v),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),k("div",null,[g(V,{"model-value":r.value,"onUpdate:modelValue":u[1]||(u[1]=v=>r.value=v),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),k("div",re,[g($,{onClick:D,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),g($,{onClick:A,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[X,w.value]])}}),oe={class:"flex flex-col gap-2 text-black"},ne={class:"flex flex-col gap-2"},ue={class:"flex flex-row justify-start gap-2"},de={class:"w-full flex justify-end gap-2"},ce={class:"w-full"},Ge=E({__name:"CategoryView",setup(F){const l=c({visible:!1,type:"add",header:"Tambah Kategori",useStay:!1}),i=Z(),s=c(),m=c(),n=c([]),t=c({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),r=c([]),w=c(!1),_=M(()=>[{label:"Edit",icon:"edit",visible:N("category").update,command:()=>{var e;n.value=[],l.value={visible:!0,type:"edit",header:"Edit Kategori",useStay:!1},s.value=(e=m.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:N("category").delete,command:()=>{n.value=[],r.value=[m.value],t.value={visible:!0,header:"Hapus Kategori",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus kategori ini?",list:r.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),b=M(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:N("category").delete,command:()=>{r.value=n.value,t.value={visible:!0,header:"Hapus Kategori",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus kategori ini?",list:r.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),x=[{header:"Kategori",field:"name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?K(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?K(new Date(e.createdAt)):"-"}],A=()=>{m.value=void 0,n.value=[],l.value={visible:!0,type:"add",header:"Tambah Kategori",useStay:!0}},D=async e=>{try{const{data:a}=await C.getCategory(e);return a}catch(a){console.error("Error fetching category data:",a)}},S=e=>{l.value.type==="add"?(w.value=(e==null?void 0:e.stay)??!1,o()):l.value.type==="edit"&&u()},B=async()=>{await v(r.value.map(e=>e.id))},o=async()=>{var e,a;try{if(!s.value){i.add({severity:"warn",summary:"Warning",detail:"Kategori tidak boleh kosong",life:3e3});return}if(s.value.length>100){i.add({severity:"warn",summary:"Warning",detail:"Nama kategori tidak boleh lebih dari 100 karakter",life:3e3});return}await C.createCategory({name:s.value}),s.value="",l.value.visible=!1,w.value?l.value.visible=!0:l.value.visible=!1,i.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah kategori",life:3e3}),m.value=void 0,n.value=[],h.emit("data-table:update",{tableName:"table-category"})}catch(d){console.error("Error creating category:",d),i.add({severity:"error",summary:"Gagal",detail:d?(a=(e=d.response)==null?void 0:e.data)==null?void 0:a.message:"Gagal menambah kategori",life:3e3})}},u=async()=>{var e,a,d;try{if(!m.value){i.add({severity:"warn",summary:"Warning",detail:"Tidak ada kategori yang dipilih untuk diubah",life:3e3});return}if(!s.value){i.add({severity:"warn",summary:"Warning",detail:"Kategori tidak boleh kosong",life:3e3});return}if(s.value.length>100){i.add({severity:"warn",summary:"Warning",detail:"Nama kategori tidak boleh lebih dari 100 karakter",life:3e3});return}await C.editCategory((e=m.value)==null?void 0:e.id,{name:s.value}),l.value.visible=!1,i.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah kategori",life:3e3}),h.emit("data-table:update",{tableName:"table-category"}),m.value=void 0,n.value=[]}catch(f){console.error("Error updating category:",f),i.add({severity:"error",summary:"Gagal",detail:f?(d=(a=f.response)==null?void 0:a.data)==null?void 0:d.message:"Gagal mengubah kategori",life:3e3})}},v=async e=>{var a,d;try{if(e.length===0){i.add({severity:"warn",summary:"Warning",detail:"Tidak ada kategori yang dipilih untuk dihapus",life:3e3});return}const f={id:e};await C.deleteCategory(f),t.value.visible=!1,i.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus kategori",life:3e3}),h.emit("data-table:update",{tableName:"table-category"}),m.value=void 0,n.value=[]}catch(f){console.error("Error deleting category:",f),i.add({severity:"error",summary:"Gagal",detail:f?(d=(a=f.response)==null?void 0:a.data)==null?void 0:d.message:"Gagal menghapus kategori",life:3e3})}},p=()=>{s.value=void 0};return ee(()=>l.value.visible,()=>{l.value.visible||p()},{immediate:!0}),(e,a)=>{var d,f;return T(),G(ae,null,[g(L,null,{default:U(()=>[k("div",oe,[k("div",ne,[k("div",ue,[g(J,{"selected-data":n.value,"onUpdate:selectedData":a[0]||(a[0]=y=>n.value=y),options:b.value,"table-name":"table-category"},null,8,["selected-data","options"]),k("div",de,[g(R,{"table-name":"table-category"}),g(j,{"table-name":"table-category"}),ie(N)("category").create?(T(),te($,{key:0,onClick:A,label:"Tambah Kategori",severity:"primary",class:"text-xs"})):le("",!0)])]),g(se,{"table-name":"table-category"}),g(O,{"data-key":"id","fetch-function":D,columns:x,options:_.value,onToggleOption:a[1]||(a[1]=y=>m.value=y),"onUpdate:selectedData":a[2]||(a[2]=y=>n.value=y),"table-name":"table-category","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),g(H,{visible:l.value.visible,"onUpdate:visible":[a[4]||(a[4]=y=>l.value.visible=y),l.value.visible],header:(d=l.value)==null?void 0:d.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(f=l.value)==null?void 0:f.useStay,"use-close":!0,closable:!1,onSubmit:S},{default:U(()=>[k("div",ce,[g(P,{modelValue:s.value,"onUpdate:modelValue":a[3]||(a[3]=y=>s.value=y),label:"Kategori",placeholder:"Masukkan kategori"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),g(W,{visible:t.value.visible,"onUpdate:visible":a[5]||(a[5]=y=>t.value.visible=y),onConfirm:B,header:t.value.header,"header-icon":"check",list:t.value.list,message:t.value.message,severity:t.value.severity,"confirm-button-severity":t.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64)}}});export{Ge as default};
