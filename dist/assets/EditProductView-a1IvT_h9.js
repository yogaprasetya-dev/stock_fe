import{u as E,G as I,O as V,v as d,p as N,w as G,o as K,y as r,b as m,P as W,E as H}from"./index-hWW29s6s.js";import{_ as $}from"./Card.vue_vue_type_script_setup_true_lang-Crk-f3gY.js";import{_ as y}from"./Dropdown.vue_vue_type_script_setup_true_lang-hL_AeIO6.js";import{_ as f}from"./InputText.vue_vue_type_script_setup_true_lang-B0hOXlSt.js";import{P as B}from"./product.service-yB8SbRJL.js";import{B as R}from"./brand.service-D0LgZ-mT.js";import{C as j}from"./category.service-m7XXqeBr.js";import{U as F}from"./unit.service-DwnMr5Q7.js";import{g as T}from"./data.utils-eGwCzW_2.js";import"./index-BiJc2Fi6.js";import"./index-DKMYSfv0.js";import"./index-CFJ9N7VM.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-Bj-gQ17_.js";import"./index-QJmaLRHl.js";import"./api.service-D-b--VpV.js";import"./index-MGwmnnen.js";const q={class:"flex items-center gap-10"},z={class:"w-[460px]"},A={class:"w-[460px]"},J={class:"flex items-center gap-10"},L={class:"w-[460px]"},Q={class:"w-[460px]"},X={class:"flex items-center gap-10"},Y={class:"w-[460px]"},Z={class:"w-[460px]"},fe=E({__name:"EditProductView",setup(ee){I(()=>{O(),w(),P(),_()});const C=H(),o=V(),g=d(0),u=d(),i=d(),p=d(),l=d(),s=d(),n=d(),b=d(),h=d(),k=d(),x=a=>{a==null||a.preventDefault(),C.push("/product/data")},c=()=>{var a,e,t;u.value=T(g.value,(a=l.value)==null?void 0:a.id,(e=s.value)==null?void 0:e.id,(t=n.value)==null?void 0:t.id)},D=()=>{i.value=void 0,l.value=void 0,p.value=void 0,s.value=void 0,n.value=void 0,c()},w=async()=>{try{const{data:a}=await R.getBrandDropdown();b.value=a.data}catch{o.add({severity:"error",summary:"Error",detail:"Gagal memuat data merek",life:3e3})}},P=async()=>{try{const{data:a}=await j.getCategoryDropdown();h.value=a.data}catch{o.add({severity:"error",summary:"Error",detail:"Gagal memuat data kategori",life:3e3})}},_=async()=>{try{const{data:a}=await F.getUnitDropdown();k.value=a.data}catch{o.add({severity:"error",summary:"Error",detail:"Gagal memuat data satuan",life:3e3})}},O=async()=>{try{const a=sessionStorage.getItem("product");if(!a){o.add({severity:"error",summary:"Error",detail:"ID produk tidak ditemukan",life:3e3});return}const{data:e}=await B.getProductDetail(Number(a));g.value=e.data.id,i.value=e.data.name,p.value=e.data.description,l.value={id:e.data.brand.id,name:e.data.brand.name},s.value={id:e.data.category.id,name:e.data.category.name},n.value={id:e.data.unit.id,name:e.data.unit.name},u.value=e.data.code}catch(a){console.error("Error fetching product detail:",a),o.add({severity:"error",summary:"Error",detail:"Gagal memuat detail produk",life:3e3})}},U=async()=>{var a,e,t,M,S;try{if(!i.value){o.add({severity:"warn",summary:"Warning",detail:"Nama produk harus diisi",life:3e3});return}if(!u.value){o.add({severity:"warn",summary:"Warning",detail:"Kode produk harus diisi",life:3e3});return}if(!l.value){o.add({severity:"warn",summary:"Warning",detail:"Merek harus dipilih",life:3e3});return}if(!s.value){o.add({severity:"warn",summary:"Warning",detail:"Kategori harus dipilih",life:3e3});return}if(!n.value){o.add({severity:"warn",summary:"Warning",detail:"Satuan harus dipilih",life:3e3});return}if(i.value.length>100){o.add({severity:"warn",summary:"Warning",detail:"Nama produk tidak boleh lebih dari 100 karakter",life:3e3});return}const v={name:i.value,code:u.value,description:p.value,brandId:(a=l.value)==null?void 0:a.id,categoryId:(e=s.value)==null?void 0:e.id,unitId:(t=n.value)==null?void 0:t.id};await B.updateProduct(g.value,v),o.add({severity:"success",summary:"Sukses",detail:"Produk berhasil diperbarui",life:3e3}),x()}catch(v){console.error("Error creating product:",v),o.add({severity:"error",summary:"Gagal",detail:v?(S=(M=v.response)==null?void 0:M.data)==null?void 0:S.message:"Gagal memperbarui produk",life:3e3})}};return(a,e)=>(K(),N($,null,{default:G(()=>[r("form",{class:"flex flex-col p-4 gap-3",onSubmit:W(U,["prevent"])},[r("div",q,[r("div",z,[m(f,{"model-value":u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),label:"Kode Produk",placeholder:"Kode produk",disabled:""},null,8,["model-value"])]),r("div",A,[m(f,{"model-value":i.value,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),label:"Nama Produk",placeholder:"Masukkan Nama Produk",onBlur:e[2]||(e[2]=()=>{})},null,8,["model-value"])])]),r("div",J,[r("div",L,[m(f,{"model-value":p.value,"onUpdate:modelValue":e[3]||(e[3]=t=>p.value=t),label:"Deskripsi Produk",placeholder:"Masukkan Deskripsi Produk",mandatory:!1,optional:!0,onBlur:e[4]||(e[4]=()=>{})},null,8,["model-value"])]),r("div",Q,[m(y,{"model-value":l.value,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value=t),placeholder:"Pilih Merek",label:"Merek",options:b.value,onOpen:w,onHide:c},null,8,["model-value","options"])])]),r("div",X,[r("div",Y,[m(y,{"model-value":s.value,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value=t),placeholder:"Pilih Kategori",label:"Kategori",options:h.value,onOpen:P,onHide:c},null,8,["model-value","options"])]),r("div",Z,[m(y,{"model-value":n.value,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value=t),placeholder:"Pilih Satuan",label:"Satuan",options:k.value,onOpen:_,onHide:c},null,8,["model-value","options"])])]),r("div",{class:"flex justify-end pt-8"},[r("div",{class:"flex flex-col gap-4 items-end"},[r("div",{class:"flex gap-2"},[r("button",{type:"button",onClick:x,class:"text-xs rounded-sm !px-2 !py-1 bg-black text-white hover:bg-black/60 hover:cursor-pointer shadow-md border-1 border-gray-600"}," Kembali "),r("button",{type:"button",onClick:D,class:"text-xs rounded-sm !px-2 !py-1 bg-transparent text-red-500 hover:bg-red-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-red-500"}," Bersihkan Input "),e[8]||(e[8]=r("button",{type:"submit",class:"text-xs rounded-sm !px-2 !py-1 bg-green-400 text-white hover:bg-green-400/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-green-500"}," Submit ",-1))])])])],32)]),_:1}))}});export{fe as default};
