import{_ as k}from"./api.service-Dgs1boU1.js";import{_ as w}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{S as B}from"./stock.service-C4NW6Gnu.js";import{f as $}from"./data.utils-Cp1LBIu0.js";import{_ as T}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import{_ as C}from"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import{_ as L}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{e as M}from"./index-CFjhT2rJ.js";import{E as N,a as V}from"./jspdf.plugin.autotable-DIFAje1Q.js";import{u as A,v as n,p as R,w as K,o as O,z as r,A as j,b as c}from"./index-DOh3iN_U.js";import"./auth.service-BxJEy6Ur.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";const q={class:"flex flex-col gap-3 text-black"},D={class:"flex flex-row gap-1 w-fit"},E={class:"text-sm text-center"},P={class:"flex flex-col gap-2 pt-2"},Q={class:"flex flex-row justify-start gap-2 w-full"},U={class:"grid grid-cols-2 gap-2 w-full"},z={class:"w-full flex justify-end gap-2"},I={class:"flex items-center gap-1"},de=A({__name:"ReportProductOutView",setup(J){const g=n(),a=n(),m=n([]),b=n([["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang"]]),d=n([]),v=[{field:"date",header:"Tanggal Transaksi",sortable:!1,bodyTemplate:e=>e.date?$(new Date(e.date)):"-"},{field:"product.code",header:"Kode Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(o=>({value:`${o.code}`}))}}},{field:"product.name",header:"Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(o=>({value:`${o.name}`}))}}},{field:"product.quantity",header:"Jumlah Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(o=>({value:`${o.quantity}`}))}}},{field:"fromStore",header:"Sumber Barang",sortable:!1,bodyTemplate:e=>e.fromStore?e==null?void 0:e.fromStore:"-"}],h=()=>{var l,i;if(!a.value)return;const e=((l=a==null?void 0:a.value)==null?void 0:l.getMonth())+1,t=(i=a==null?void 0:a.value)==null?void 0:i.getFullYear(),o={month:e,year:t};M.emit("data-table:apply-filter",{tableName:"table-report-product-out",filter:o})},_=()=>{const e=new N;let t=1;const o=a.value?a.value.toLocaleDateString("id-ID",{month:"long",year:"numeric"}):"";e.text("Laporan Barang Keluar",105,10,{align:"center"}),e.text("Agen Sembako Mbak Endang",105,20,{align:"center"}),e.text(o,105,30,{align:"center"});const l=new Map;for(const s of m.value){const f=new Date(s.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});for(const u of s.products){const p=`${f}||${u.code}||${s.fromStore}`;l.has(p)||l.set(p,{date:f,code:u.code,productName:u.name,totalQty:0,fromStore:s.fromStore});const S=l.get(p);S.totalQty+=u.quantity}}for(const s of l.values())d.value.push([t++,s.date,s.code,s.productName,s.totalQty.toString(),s.fromStore]);V(e,{head:b.value,body:d.value,styles:{fontSize:9},headStyles:{fillColor:[0,123,255]},margin:{top:40}});const i=e.output("blob"),x=URL.createObjectURL(i);window.open(x)},y=async e=>{var t;try{const{data:o}=await B.getStockOutReport(e);return m.value=((t=o==null?void 0:o.data)==null?void 0:t.data)||[],o}catch(o){console.error("Error fetching store stock:",o)}};return(e,t)=>(O(),R(k,null,{default:K(()=>{var o;return[r("div",q,[r("div",D,[t[1]||(t[1]=r("span",{class:"text-lg font-semibold"},"Laporan Barang Keluar",-1)),r("span",E,j((o=g.value)==null?void 0:o.name),1)]),r("div",P,[r("div",Q,[r("div",U,[r("div",null,[c(T,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value=l),view:"month",dateFormat:"MM yy",placeholder:"Pilih Bulan & Tahun Transaksi"},null,8,["modelValue"])]),r("div",null,[c(L,{onClick:h,label:"Terapkan",severity:"primary",class:"text-xs"})])]),r("div",z,[r("button",{onClick:_,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-500 text-white hover:bg-blue-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-blue-600"},[r("div",I,[c(C,{icon:"printer"}),t[2]||(t[2]=r("span",null,"Cetak Laporan",-1))])])])]),c(w,{"data-key":"id","fetch-function":y,columns:v,"use-options":!1,"table-name":"table-report-product-out","selection-type":"single","use-paginator":""})])])]}),_:1}))}});export{de as default};
