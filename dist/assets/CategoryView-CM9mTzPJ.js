import{_ as G}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{C}from"./category.service-DKdRWdqU.js";import{_ as O}from"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import{_ as J}from"./Dialog.vue_vue_type_script_setup_true_lang-BwIWKMFo.js";import{e as g}from"./index-CFjhT2rJ.js";import{_ as L}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Cvyx0ufE.js";import{_ as H}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{f as E}from"./data.utils-Cp1LBIu0.js";import{_ as $}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as I}from"./api.service-Dgs1boU1.js";import{_ as R,a as j}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{u as V,v as u,a5 as z,y as q,K as Q,q as W,a6 as X,o as T,c as P,a7 as Y,z as y,b as n,M as Z,I as B,a4 as S,L as ee,w as K,F as ae,D as te,p as le,t as se,x as ie}from"./index-DOh3iN_U.js";import{_ as U}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";import"./auth.service-BxJEy6Ur.js";const oe={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},re=V({inheritAttrs:!1,__name:"CategoryFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(F,{emit:s}){const d=u(4),c=u(),v=u(),b=u(),t=u([]),l=u([]),k=z(!1),h=u(null),f=F,_=s;q(()=>{N(),g.on("show-filter",w)}),Q(()=>{g.off("show-filter",w)});const A=()=>{const i={};if(g.emit("multi-select:hide-overlay"),c.value&&c.value.length>0&&(i.brand=JSON.stringify(c.value)),v.value&&v.value.length>0&&(i.category=JSON.stringify(v.value)),b.value&&b.value.length>0&&(i.unit=JSON.stringify(b.value)),t.value&&t.value.length>0){const o=t.value[0]?new Date(t.value[0]):null,r=t.value[1]?new Date(t.value[1]):new Date(t.value[0]),m=[o];r&&m.push(r),i.updatedAt=JSON.stringify(m)}if(l.value&&l.value.length>0){const o=l.value[0]?new Date(l.value[0]):null,r=l.value[1]?new Date(l.value[1]):new Date(l.value[0]),m=[o];r&&m.push(r),i.createdAt=JSON.stringify(m)}g.emit("data-table:apply-filter",{tableName:f==null?void 0:f.tableName,filter:i}),g.emit("data-table:clear-selected-data",{tableName:f==null?void 0:f.tableName}),_==null||_("apply",i)},D=()=>{t.value=[],l.value=[]},w=i=>{i.tableName===f.tableName&&(k.value=i.show)},N=()=>{if(h.value){const{children:i}=h.value,o=h.value.childElementCount,r=o%d.value;let[m,e]=[1,1];for(const a in Array.from({length:o})){const x=Number(a)===o-1;i[a].setAttribute("style",`grid-area: ${m}/${x&&r?d.value:e}`),++e>d.value&&(e=1,m++)}}};return(i,o)=>W((T(),P("div",{ref_key:"container",ref:h,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:Y(`grid-template-columns: repeat(${d.value}, 1fr)`)},[y("div",null,[n(U,{"model-value":t.value,"onUpdate:modelValue":o[0]||(o[0]=r=>t.value=r),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),y("div",null,[n(U,{"model-value":l.value,"onUpdate:modelValue":o[1]||(o[1]=r=>l.value=r),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),y("div",oe,[n($,{onClick:D,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),n($,{onClick:A,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[X,k.value]])}}),ne={class:"flex flex-col gap-2 text-black"},ue={class:"flex flex-col gap-2"},ce={class:"flex flex-row justify-start gap-2"},de={class:"w-full flex justify-end gap-2"},me={class:"w-full"},Pe=V({__name:"CategoryView",setup(F){const s=u({visible:!1,type:"add",header:"Tambah Kategori",useStay:!1}),d=Z(),c=u(),v=u(),b=u([]),t=u({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),l=u([]),k=B(()=>[{label:"Edit",icon:"edit",visible:S("category").update,command:()=>{var e;s.value={visible:!0,type:"edit",header:"Edit Kategori",useStay:!1},c.value=(e=v.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:S("category").delete,command:()=>{l.value=[v.value],t.value={visible:!0,header:"Hapus Kategori",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus kategori ini?",list:l.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),h=B(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:S("category").delete,command:()=>{l.value=b.value,t.value={visible:!0,header:"Edit Kategori",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin mengubah kategori ini?",list:l.value.map(e=>e.name),confirmLabel:"Ubah",actionable:!0}}}]),f=[{header:"Kategori",field:"name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?E(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?E(new Date(e.createdAt)):"-"}],_=B(()=>b.value.length>0),A=()=>{s.value={visible:!0,type:"add",header:"Tambah Kategori",useStay:!0}},D=async e=>{try{const{data:a}=await C.getCategory(e);return a}catch(a){console.error("Error fetching category data:",a)}},w=e=>{s.value.type==="add"?i():s.value.type==="edit"&&o()},N=async()=>{await r(l.value.map(e=>e.id))},i=async()=>{try{if(!c.value)return;await C.createCategory({name:c.value}),c.value="",s.value.visible=!1,d.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah kategori",life:3e3}),g.emit("data-table:update",{tableName:"table-category"})}catch(e){console.error("Error creating category:",e),d.add({severity:"error",summary:"Gagal",detail:"Gagal menambah kategori",life:3e3})}},o=async()=>{var e;try{if(!v.value)return;await C.editCategory((e=v.value)==null?void 0:e.id,{name:c.value}),s.value.visible=!1,d.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah kategori",life:3e3}),g.emit("data-table:update",{tableName:"table-category"})}catch(a){console.error("Error updating category:",a),d.add({severity:"error",summary:"Gagal",detail:"Gagal mengubah kategori",life:3e3})}},r=async e=>{try{const a={id:e};await C.deleteCategory(a),t.value.visible=!1,d.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus kategori",life:3e3}),g.emit("data-table:update",{tableName:"table-category"})}catch(a){console.error("Error deleting category:",a),d.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus kategori",life:3e3})}},m=()=>{c.value=void 0};return ee(()=>s.value.visible,()=>{s.value.visible||m()},{immediate:!0}),(e,a)=>{var x,M;return T(),P(ae,null,[n(I,null,{default:K(()=>[y("div",ne,[y("div",ue,[y("div",ce,[n(L,{options:h.value,class:te(`${_.value?"flex":"!hidden"} h-[21px] w-[120px]`)},null,8,["options","class"]),y("div",de,[n(R,{"table-name":"table-category"}),n(j,{"table-name":"table-category"}),ie(S)("category").create?(T(),le($,{key:0,onClick:A,label:"Tambah Kategori",severity:"primary",class:"text-xs"})):se("",!0)])]),n(re,{"table-name":"table-category"}),n(G,{"data-key":"id","fetch-function":D,columns:f,options:k.value,onToggleOption:a[0]||(a[0]=p=>v.value=p),"onUpdate:selectedData":a[1]||(a[1]=p=>b.value=p),"table-name":"table-category","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),n(J,{visible:s.value.visible,"onUpdate:visible":[a[3]||(a[3]=p=>s.value.visible=p),s.value.visible],header:(x=s.value)==null?void 0:x.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(M=s.value)==null?void 0:M.useStay,"use-close":!0,closable:!1,onSubmit:w},{default:K(()=>[y("div",me,[n(O,{modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=p=>c.value=p),label:"Kategori",placeholder:"Masukkan kategori"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),n(H,{visible:t.value.visible,"onUpdate:visible":a[4]||(a[4]=p=>t.value.visible=p),onConfirm:N,header:t.value.header,"header-icon":"check",list:t.value.list,message:t.value.message,severity:t.value.severity,"confirm-button-severity":t.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64)}}});export{Pe as default};
