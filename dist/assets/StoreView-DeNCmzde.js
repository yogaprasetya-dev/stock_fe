import{_ as j}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{_ as z}from"./Breadcrumb.vue_vue_type_script_setup_true_lang-BPPSNlYI.js";import{S as $}from"./store.service-DK6LsYTS.js";import{_ as K}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Cvyx0ufE.js";import{_ as F}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as q}from"./Dialog.vue_vue_type_script_setup_true_lang-BwIWKMFo.js";import{_ as Q}from"./DialogConfirm.vue_vue_type_script_setup_true_lang-BHok5e_l.js";import{_ as W}from"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import{e as h}from"./index-CFjhT2rJ.js";import{f as G}from"./data.utils-Cp1LBIu0.js";import{_ as X}from"./api.service-Dgs1boU1.js";import{u as L,v as d,a5 as Y,y as Z,K as ee,q as ae,a6 as te,o as A,c as E,a7 as se,z as y,b as n,M as le,I as S,a4 as x,E as oe,J as ie,L as re,p as O,F as ne,w as R,r as ue,D as ce,t as de,x as me}from"./index-DOh3iN_U.js";import{_ as ve,a as fe}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{_ as J}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-_ukIlSQ8.js";import"./auth.service-BxJEy6Ur.js";const pe={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},be=L({inheritAttrs:!1,__name:"StoreFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(U,{emit:s}){const g=d(4),_=d(),m=d(),i=d(),t=d([]),l=d([]),u=Y(!1),v=d(null),p=U,k=s;Z(()=>{N(),h.on("show-filter",D)}),ee(()=>{h.off("show-filter",D)});const B=()=>{const o={};if(h.emit("multi-select:hide-overlay"),_.value&&_.value.length>0&&(o.brand=JSON.stringify(_.value)),m.value&&m.value.length>0&&(o.category=JSON.stringify(m.value)),i.value&&i.value.length>0&&(o.unit=JSON.stringify(i.value)),t.value&&t.value.length>0){const r=t.value[0]?new Date(t.value[0]):null,c=t.value[1]?new Date(t.value[1]):new Date(t.value[0]),f=[r];c&&f.push(c),o.updatedAt=JSON.stringify(f)}if(l.value&&l.value.length>0){const r=l.value[0]?new Date(l.value[0]):null,c=l.value[1]?new Date(l.value[1]):new Date(l.value[0]),f=[r];c&&f.push(c),o.createdAt=JSON.stringify(f)}h.emit("data-table:apply-filter",{tableName:p==null?void 0:p.tableName,filter:o}),h.emit("data-table:clear-selected-data",{tableName:p==null?void 0:p.tableName}),k==null||k("apply",o)},C=()=>{t.value=[],l.value=[]},D=o=>{o.tableName===p.tableName&&(u.value=o.show)},N=()=>{if(v.value){const{children:o}=v.value,r=v.value.childElementCount,c=r%g.value;let[f,w]=[1,1];for(const T in Array.from({length:r})){const M=Number(T)===r-1;o[T].setAttribute("style",`grid-area: ${f}/${M&&c?g.value:w}`),++w>g.value&&(w=1,f++)}}};return(o,r)=>ae((A(),E("div",{ref_key:"container",ref:v,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:se(`grid-template-columns: repeat(${g.value}, 1fr)`)},[y("div",null,[n(J,{"model-value":t.value,"onUpdate:modelValue":r[0]||(r[0]=c=>t.value=c),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),y("div",null,[n(J,{"model-value":l.value,"onUpdate:modelValue":r[1]||(r[1]=c=>l.value=c),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),y("div",pe,[n(F,{onClick:C,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),n(F,{onClick:B,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[te,u.value]])}}),ye={id:"main-view",class:"bg-[#eeedf2] w-full overflow-y-hidden"},he={class:"flex flex-col gap-2 p-4"},ge={class:"flex flex-col gap-2 text-black"},_e={class:"flex flex-col gap-2"},ke={class:"flex flex-row justify-start gap-2"},we={class:"w-full flex justify-end gap-2"},Se={class:"w-full"},We=L({__name:"StoreView",setup(U){const s=d({visible:!1,type:"add",header:"Tambah Kategori",useStay:!1}),g=oe(),_=ie(),m=le(),i=d(),t=d(),l=d([]),u=d({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),v=d([]),p=S(()=>[{label:"Stock",icon:"box-3",visible:x("store_stock").view,command:()=>{var e;sessionStorage.setItem("store",String((e=t.value)==null?void 0:e.id)),g.push("/store/stock")}},{label:"Edit",icon:"edit",visible:x("store").update,command:()=>{var e;s.value={visible:!0,type:"edit",header:"Edit Toko",useStay:!1},i.value=(e=t.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:x("store").delete,command:()=>{v.value=[t.value],u.value={visible:!0,header:"Hapus Toko",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menghapus toko ini?",list:v.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),k=S(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:x("store").delete,command:()=>{v.value=l.value,u.value={visible:!0,header:"Edit Kategori",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin mengubah kategori ini?",list:v.value.map(e=>e.name),confirmLabel:"Ubah",actionable:!0}}}]),B=[{header:"Toko",field:"name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?G(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?G(new Date(e.createdAt)):"-"}],C=S(()=>{let e=[{name:"Toko",route:"/store"}];return N.value==="stock"&&(e=[...e,{name:"Stock",route:"/store/stock"}]),e}),D=S(()=>l.value.length>0),N=S(()=>_.path.split("/").pop()),o=()=>{s.value={visible:!0,type:"add",header:"Tambah Toko",useStay:!0}},r=e=>{s.value.type==="add"?w():s.value.type==="edit"&&T()},c=async()=>{await M(v.value.map(e=>e.id))},f=async e=>{try{const{data:a}=await $.getStore(e);return a}catch(a){console.error("Error fetching store data:",a)}},w=async()=>{try{if(!i.value)return;await $.createStore({name:i.value}),s.value.visible=!1,i.value="",m.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah toko",life:3e3}),h.emit("data-table:update",{tableName:"table-store"})}catch(e){console.error("Error creating store:",e),m.add({severity:"error",summary:"Gagal",detail:"Gagal menambah toko",life:3e3})}},T=async()=>{try{if(!i.value||!t.value)return;await $.updateStore(t.value.id,{name:i.value}),s.value.visible=!1,i.value="",m.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah toko",life:3e3}),h.emit("data-table:update",{tableName:"table-store"})}catch(e){console.error("Error updating store:",e),m.add({severity:"error",summary:"Gagal",detail:"Gagal mengubah toko",life:3e3})}},M=async e=>{try{const a={id:e};await $.deleteStore(a),u.value.visible=!1,l.value=[],m.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus toko",life:3e3}),h.emit("data-table:update",{tableName:"table-store"})}catch(a){console.error("Error deleting store:",a),m.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus toko",life:3e3})}},I=()=>{i.value=void 0};return re(()=>s.value.visible,()=>{s.value.visible||I()},{immediate:!0}),(e,a)=>{var V,P;const H=ue("router-view");return A(),E("div",ye,[y("div",he,[n(z,{menus:C.value},null,8,["menus"]),N.value==="stock"?(A(),O(H,{key:0})):(A(),E(ne,{key:1},[n(X,null,{default:R(()=>[y("div",ge,[y("div",_e,[y("div",ke,[n(K,{options:k.value,class:ce(`${D.value?"flex":"!hidden"} h-[21px] w-[120px]`)},null,8,["options","class"]),y("div",we,[n(ve,{"table-name":"table-store"}),n(fe,{"table-name":"table-store"}),me(x)("store").create?(A(),O(F,{key:0,onClick:o,label:"Tambah Toko",severity:"primary",class:"text-xs"})):de("",!0)])]),n(be,{"table-name":"table-store"}),n(j,{"data-key":"id","fetch-function":f,columns:B,options:p.value,onToggleOption:a[0]||(a[0]=b=>t.value=b),"onUpdate:selectedData":a[1]||(a[1]=b=>l.value=b),"table-name":"table-store","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),n(q,{visible:s.value.visible,"onUpdate:visible":[a[3]||(a[3]=b=>s.value.visible=b),s.value.visible],header:(V=s.value)==null?void 0:V.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(P=s.value)==null?void 0:P.useStay,"use-close":!0,closable:!1,onSubmit:r},{default:R(()=>[y("div",Se,[n(W,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=b=>i.value=b),label:"Nama Toko",placeholder:"Masukkan nama toko"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),n(Q,{visible:u.value.visible,"onUpdate:visible":a[4]||(a[4]=b=>u.value.visible=b),onConfirm:c,header:u.value.header,"header-icon":"check",list:u.value.list,message:u.value.message,severity:u.value.severity,"confirm-button-severity":u.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64))])])}}});export{We as default};
