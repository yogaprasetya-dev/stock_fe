import{_ as S}from"./Card.vue_vue_type_script_setup_true_lang-Crk-f3gY.js";import{_ as k}from"./DataTable.vue_vue_type_script_setup_true_lang-Bv2GBGut.js";import{S as T}from"./stock.service-DU24jw1z.js";import{f as w}from"./data.utils-eGwCzW_2.js";import{_ as M}from"./DatePicker.vue_vue_type_script_setup_true_lang-HpdiHGB9.js";import{_ as V}from"./Icon.vue_vue_type_script_setup_true_lang-DQpuTSIJ.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-C3EZ6wIy.js";import{e as $}from"./index-CFjhT2rJ.js";import{E as C,a as L}from"./jspdf.plugin.autotable-Bx7fSw7r.js";import{s as v}from"./index-wcSDmgdM.js";import{u as j,v as u,N as b,p as R,w as U,o as A,y as o,b as n,x as y}from"./index-hWW29s6s.js";import"./Animation-DnZbilmd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-TVW8kvF3.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-Bj-gQ17_.js";import"./index-QJmaLRHl.js";import"./index-BiJc2Fi6.js";import"./index-DKMYSfv0.js";import"./api.service-D-b--VpV.js";import"./index-MGwmnnen.js";import"./index-DfSJzKmE.js";import"./index-BgKJ5Lam.js";const I={class:"flex flex-col gap-3 text-black"},P={class:"flex flex-col gap-2 pt-2"},q={class:"flex flex-row justify-start gap-2 w-full items-center"},z={class:"pr-4"},E={class:"flex gap-4 py-1 !text-xs"},J={class:"flex items-center gap-2"},K={class:"flex items-center gap-2"},Q={class:"grid grid-cols-2 gap-2 w-full"},Y={class:"w-full flex justify-end gap-2"},O={class:"flex items-center gap-1"},ve=j({__name:"ReportProductMutationView",setup(F){const s=u("date"),r=u(),c=u([]),g=u([["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang","Tujuan Barang"]]),i=u([]),h=[{field:"date",header:"Tanggal Transaksi",sortable:!1,bodyTemplate:e=>e.date?w(new Date(e.date)):"-"},{field:"product.code",header:"Kode Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(a=>({value:`${a.code}`}))}}},{field:"product.name",header:"Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(a=>({value:`${a.name}`}))}}},{field:"product.quantity",header:"Jumlah Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(a=>({value:`${a.quantity}`}))}}},{field:"fromStore",header:"Sumber Barang",sortable:!1,bodyTemplate:e=>e.fromStore?e==null?void 0:e.fromStore:"-"},{field:"toStore",header:"Tujuan Barang",sortable:!1,bodyTemplate:e=>e.toStore?e==null?void 0:e.toStore:"-"}],x=()=>{var d,m,l;if(!r.value)return;const e=((d=r==null?void 0:r.value)==null?void 0:d.getMonth())+1,t=(m=r==null?void 0:r.value)==null?void 0:m.getFullYear(),a={month:e,year:t};s.value==="date"&&(a.date=(l=r==null?void 0:r.value)==null?void 0:l.getDate()),$.emit("data-table:apply-filter",{tableName:"table-report-product-mutation",filter:a})},_=()=>{const e=new C,t=r.value?r.value.toLocaleDateString("id-ID",s.value==="date"?{day:"2-digit",month:"long",year:"numeric"}:{month:"long",year:"numeric"}):"";e.text("Laporan Barang Mutasi",105,10,{align:"center"}),e.text("Agen Sembako Mbak Endang",105,20,{align:"center"}),e.text(t,105,30,{align:"center"});let a=[];for(const l of c.value){const p=new Date(l.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});for(const f of l.products)a.push({date:p,code:f.code,productName:f.name,totalQty:f.quantity,fromStore:l.fromStore,toStore:l.toStore})}a.map((l,p)=>{i.value.push([p+1,l.date,l.code,l.productName,l.totalQty.toString(),l.fromStore,l.toStore])}),L(e,{head:g.value,body:i.value,styles:{fontSize:9},headStyles:{fillColor:[0,123,255]},margin:{top:40}});const d=e.output("blob"),m=URL.createObjectURL(d);window.open(m),i.value=[]},B=async e=>{var t;try{const{data:a}=await T.getStockMutationReport(e);return c.value=((t=a==null?void 0:a.data)==null?void 0:t.data)||[],a}catch(a){console.error("Error fetching store stock:",a)}};return b(()=>r.value,()=>{i.value=[],g.value=[["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang","Tujuan Barang"]]}),b(()=>s.value,()=>{s.value&&(r.value=void 0)},{immediate:!0}),(e,t)=>(A(),R(S,null,{default:U(()=>[o("div",I,[t[7]||(t[7]=o("div",{class:"flex flex-row gap-1 w-fit"},[o("span",{class:"text-lg font-semibold"},"Laporan Barang Mutasi")],-1)),o("div",P,[o("div",q,[o("div",z,[t[5]||(t[5]=o("span",{class:"text-xs"},"Filter Berdasarkan",-1)),o("div",E,[o("div",J,[n(y(v),{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value=a),inputId:"date",name:"date",value:"date",size:"small"},null,8,["modelValue"]),t[3]||(t[3]=o("label",{for:"warehouse"},"Tanggal",-1))]),o("div",K,[n(y(v),{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value=a),inputId:"month",name:"month",value:"month",size:"small"},null,8,["modelValue"]),t[4]||(t[4]=o("label",{for:"store"},"Bulan",-1))])])]),o("div",Q,[o("div",null,[n(M,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=a=>r.value=a),view:s.value==="date"?"date":"month",dateFormat:s.value==="date"?"dd MM yy":"MM yy",placeholder:s.value==="date"?"Pilih Tanggal Transaksi":"Pilih Bulan & Tahun Transaksi"},null,8,["modelValue","view","dateFormat","placeholder"])]),o("div",null,[n(N,{onClick:x,label:"Terapkan",severity:"primary",class:"text-xs"})])]),o("div",Y,[o("button",{onClick:_,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-500 text-white hover:bg-blue-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-blue-600"},[o("div",O,[n(V,{icon:"printer"}),t[6]||(t[6]=o("span",null,"Cetak Laporan",-1))])])])]),n(k,{"data-key":"id","fetch-function":B,columns:h,"use-options":!1,"table-name":"table-report-product-mutation","selection-type":"single","use-paginator":""})])])]),_:1}))}});export{ve as default};
