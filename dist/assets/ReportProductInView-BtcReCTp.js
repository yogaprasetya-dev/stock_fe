import{_ as B}from"./Card.vue_vue_type_script_setup_true_lang-Crk-f3gY.js";import{_ as w}from"./DataTable.vue_vue_type_script_setup_true_lang-Bv2GBGut.js";import{S as T}from"./stock.service-DU24jw1z.js";import{f as S}from"./data.utils-eGwCzW_2.js";import{_ as V}from"./DatePicker.vue_vue_type_script_setup_true_lang-HpdiHGB9.js";import{_ as M}from"./Icon.vue_vue_type_script_setup_true_lang-DQpuTSIJ.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-C3EZ6wIy.js";import{e as $}from"./index-CFjhT2rJ.js";import{E as C,a as I}from"./jspdf.plugin.autotable-Bx7fSw7r.js";import{s as v}from"./index-wcSDmgdM.js";import{u as L,v as i,N as b,p as j,w as R,o as U,y as o,b as n,x as y}from"./index-hWW29s6s.js";import"./Animation-DnZbilmd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-TVW8kvF3.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-Bj-gQ17_.js";import"./index-QJmaLRHl.js";import"./index-BiJc2Fi6.js";import"./index-DKMYSfv0.js";import"./api.service-D-b--VpV.js";import"./index-MGwmnnen.js";import"./index-DfSJzKmE.js";import"./index-BgKJ5Lam.js";const A={class:"flex flex-col gap-3 text-black"},P={class:"flex flex-col gap-2 pt-2"},q={class:"flex flex-row justify-start gap-2 w-full items-center"},z={class:"pr-4"},D={class:"flex gap-4 py-1 !text-xs"},E={class:"flex items-center gap-2"},J={class:"flex items-center gap-2"},K={class:"grid grid-cols-2 gap-2 w-full"},Q={class:"w-full flex justify-end gap-2"},Y={class:"flex items-center gap-1"},ve=L({__name:"ReportProductInView",setup(O){const s=i("date"),l=i(),f=i([]),g=i([["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Tujuan Barang"]]),u=i([]),h=[{field:"date",header:"Tanggal Transaksi",sortable:!1,bodyTemplate:t=>t.date?S(new Date(t.date)):"-"},{field:"product.code",header:"Kode Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:t=>{var e;return(e=t==null?void 0:t.products)==null?void 0:e.map(a=>({value:`${a.code}`}))}}},{field:"product.name",header:"Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:t=>{var e;return(e=t==null?void 0:t.products)==null?void 0:e.map(a=>({value:`${a.name}`}))}}},{field:"product.quantity",header:"Jumlah Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:t=>{var e;return(e=t==null?void 0:t.products)==null?void 0:e.map(a=>({value:`${a.quantity}`}))}}},{field:"toStore",header:"Tujuan Barang",sortable:!1,bodyTemplate:t=>t.toStore?t==null?void 0:t.toStore:"-"}],x=()=>{var d,p,r;if(!l.value)return;const t=((d=l==null?void 0:l.value)==null?void 0:d.getMonth())+1,e=(p=l==null?void 0:l.value)==null?void 0:p.getFullYear(),a={month:t,year:e};s.value==="date"&&(a.date=(r=l==null?void 0:l.value)==null?void 0:r.getDate()),$.emit("data-table:apply-filter",{tableName:"table-report-product-in",filter:a})},_=()=>{const t=new C,e=l.value?l.value.toLocaleDateString("id-ID",s.value==="date"?{day:"2-digit",month:"long",year:"numeric"}:{month:"long",year:"numeric"}):"";t.text("Laporan Barang Masuk",105,10,{align:"center"}),t.text("Agen Sembako Mbak Endang",105,20,{align:"center"}),t.text(e,105,30,{align:"center"});let a=[];for(const r of f.value){const m=new Date(r.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});for(const c of r.products)a.push({date:m,code:c.code,productName:c.name,totalQty:c.quantity,toStore:r.toStore})}a.map((r,m)=>{u.value.push([m+1,r.date,r.code,r.productName,r.totalQty.toString(),r.toStore])}),I(t,{head:g.value,body:u.value,styles:{fontSize:9},headStyles:{fillColor:[0,123,255]},margin:{top:40}});const d=t.output("blob"),p=URL.createObjectURL(d);window.open(p),u.value=[]},k=async t=>{var e;try{const{data:a}=await T.getStockInReport(t);return f.value=((e=a==null?void 0:a.data)==null?void 0:e.data)||[],a}catch(a){console.error("Error fetching store stock:",a)}};return b(()=>l.value,()=>{u.value=[],g.value=[["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Tujuan Barang"]]},{immediate:!0}),b(()=>s.value,()=>{s.value&&(l.value=void 0)},{immediate:!0}),(t,e)=>(U(),j(B,null,{default:R(()=>[o("div",A,[e[7]||(e[7]=o("div",{class:"flex flex-row gap-1 w-fit"},[o("span",{class:"text-lg font-semibold"},"Laporan Barang Masuk")],-1)),o("div",P,[o("div",q,[o("div",z,[e[5]||(e[5]=o("span",{class:"text-xs"},"Filter Berdasarkan",-1)),o("div",D,[o("div",E,[n(y(v),{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),inputId:"date",name:"date",value:"date",size:"small"},null,8,["modelValue"]),e[3]||(e[3]=o("label",{for:"warehouse"},"Tanggal",-1))]),o("div",J,[n(y(v),{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),inputId:"month",name:"month",value:"month",size:"small"},null,8,["modelValue"]),e[4]||(e[4]=o("label",{for:"store"},"Bulan",-1))])])]),o("div",K,[o("div",null,[n(V,{modelValue:l.value,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value=a),view:s.value==="date"?"date":"month",dateFormat:s.value==="date"?"dd MM yy":"MM yy",placeholder:s.value==="date"?"Pilih Tanggal Transaksi":"Pilih Bulan & Tahun Transaksi"},null,8,["modelValue","view","dateFormat","placeholder"])]),o("div",null,[n(N,{onClick:x,label:"Terapkan",severity:"primary",class:"text-xs"})])]),o("div",Q,[o("button",{onClick:_,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-500 text-white hover:bg-blue-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-blue-600"},[o("div",Y,[n(M,{icon:"printer"}),e[6]||(e[6]=o("span",null,"Cetak Laporan",-1))])])])]),n(w,{"data-key":"id","fetch-function":k,columns:h,"use-options":!1,"table-name":"table-report-product-in","selection-type":"single","use-paginator":""})])])]),_:1}))}});export{ve as default};
