import{_ as W}from"./DataTable.vue_vue_type_script_setup_true_lang-DeTgP4N4.js";import{_ as j}from"./Breadcrumb.vue_vue_type_script_setup_true_lang-UGa8euxH.js";import{S as B}from"./store.service-BCNcAVQn.js";import{_ as K}from"./ButtonMultiAction.vue_vue_type_script_setup_true_lang-Br5aPVo0.js";import{_ as V}from"./Button.vue_vue_type_script_setup_true_lang-CSPcqJtD.js";import{_ as q}from"./Dialog.vue_vue_type_script_setup_true_lang-BzK1eP8z.js";import{_ as z}from"./DialogConfirm.vue_vue_type_style_index_0_lang-DAdNkhY-.js";import{_ as Q}from"./InputText.vue_vue_type_script_setup_true_lang-IuxdgJoj.js";import{e as h}from"./index-CFjhT2rJ.js";import{f as R}from"./data.utils-eGwCzW_2.js";import{_ as X}from"./Card.vue_vue_type_script_setup_true_lang-UVC5jy29.js";import{u as I,v as d,a5 as Y,E as Z,L as ee,q as ae,a6 as te,o as D,c as P,a7 as se,y as b,b as u,N as le,I as C,K as N,D as oe,J as ie,M as re,p as H,F as ne,w as J,r as ue,t as de,x as me}from"./index-CUSBhvvD.js";import{_ as ce,a as ve}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-mAFaKJND.js";import{_ as L}from"./DatePicker.vue_vue_type_script_setup_true_lang-D0aihC5B.js";import"./Icon.vue_vue_type_script_setup_true_lang-Bpg0U7pi.js";import"./Animation-DM2F-Sqa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-C1SXEW8S.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-CS4RkR0W.js";import"./index-C_TFOcbt.js";import"./index-BQTReM-n.js";import"./index-MfT3pmNT.js";import"./api.service-BtxxfR6c.js";import"./index-MGwmnnen.js";import"./index-C2ZLcsP7.js";import"./index-C_sq4xT8.js";import"./index-XFOpXasB.js";const fe={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},pe=I({inheritAttrs:!1,__name:"StoreFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(G,{emit:l}){const k=d(4),w=d(),o=d(),_=d(),t=d([]),s=d([]),y=Y(!1),i=d(null),m=G,S=l;Z(()=>{T(),h.on("show-filter",A)}),ee(()=>{h.off("show-filter",A)});const F=()=>{const r={};if(h.emit("multi-select:hide-overlay"),w.value&&w.value.length>0&&(r.brand=JSON.stringify(w.value)),o.value&&o.value.length>0&&(r.category=JSON.stringify(o.value)),_.value&&_.value.length>0&&(r.unit=JSON.stringify(_.value)),t.value&&t.value.length>0){const n=t.value[0]?new Date(t.value[0]):null,c=t.value[1]?new Date(t.value[1]):new Date(t.value[0]),p=[n];c&&p.push(c),r.updatedAt=JSON.stringify(p)}if(s.value&&s.value.length>0){const n=s.value[0]?new Date(s.value[0]):null,c=s.value[1]?new Date(s.value[1]):new Date(s.value[0]),p=[n];c&&p.push(c),r.createdAt=JSON.stringify(p)}h.emit("data-table:apply-filter",{tableName:m==null?void 0:m.tableName,filter:r}),h.emit("data-table:clear-selected-data",{tableName:m==null?void 0:m.tableName}),S==null||S("apply",r)},M=()=>{t.value=[],s.value=[]},A=r=>{r.tableName===m.tableName&&(y.value=r.show)},T=()=>{if(i.value){const{children:r}=i.value,n=i.value.childElementCount,c=n%k.value;let[p,x]=[1,1];for(const $ in Array.from({length:n})){const E=Number($)===n-1;r[$].setAttribute("style",`grid-area: ${p}/${E&&c?k.value:x}`),++x>k.value&&(x=1,p++)}}};return(r,n)=>ae((D(),P("div",{ref_key:"container",ref:i,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:se(`grid-template-columns: repeat(${k.value}, 1fr)`)},[b("div",null,[u(L,{"model-value":t.value,"onUpdate:modelValue":n[0]||(n[0]=c=>t.value=c),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),b("div",null,[u(L,{"model-value":s.value,"onUpdate:modelValue":n[1]||(n[1]=c=>s.value=c),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),b("div",fe,[u(V,{onClick:M,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),u(V,{onClick:F,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[te,y.value]])}}),be={id:"main-view",class:"bg-[#eeedf2] w-full overflow-y-hidden"},ye={class:"flex flex-col gap-2 p-4"},ge={class:"flex flex-col gap-2 text-black"},he={class:"flex flex-col gap-2"},ke={class:"flex flex-row justify-start gap-2"},_e={class:"w-full flex justify-end gap-2"},we={class:"w-full"},Qe=I({__name:"StoreView",setup(G){const l=d({visible:!1,type:"add",header:"Tambah Kategori",useStay:!1}),k=oe(),w=ie(),o=le(),_=d(!1),t=d(),s=d(),y=d([]),i=d({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),m=d([]),S=C(()=>[{label:"Stock",icon:"box-3",visible:N("store_stock").view,command:()=>{var e;sessionStorage.setItem("store",String((e=s.value)==null?void 0:e.id)),k.push("/store/stock")}},{label:"Edit",icon:"edit",visible:N("store").update,command:()=>{var e;l.value={visible:!0,type:"edit",header:"Edit Toko",useStay:!1},t.value=(e=s.value)==null?void 0:e.name}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:N("store").delete,command:()=>{m.value=[s.value],i.value={visible:!0,header:"Hapus Toko",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus toko ini?",list:m.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),F=C(()=>[{label:"Hapus",icon:"delete-bin",danger:!0,visible:N("store").delete,command:()=>{m.value=y.value,i.value={visible:!0,header:"Hapus Kategori",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus kategori ini?",list:m.value.map(e=>e.name),confirmLabel:"Hapus",actionable:!0}}}]),M=[{header:"Toko",field:"name",sortable:!0},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?R(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?R(new Date(e.createdAt)):"-"}],A=C(()=>{let e=[{name:"Toko",route:"/store"}];return T.value==="stock"&&(e=[...e,{name:"Stock",route:"/store/stock"}]),e}),T=C(()=>w.path.split("/").pop()),r=()=>{l.value={visible:!0,type:"add",header:"Tambah Toko",useStay:!0}},n=e=>{l.value.type==="add"?(_.value=(e==null?void 0:e.stay)??!1,x()):l.value.type==="edit"&&$()},c=async()=>{await E(m.value.map(e=>e.id))},p=async e=>{try{const{data:a}=await B.getStore(e);return a}catch(a){console.error("Error fetching store data:",a)}},x=async()=>{var e,a;try{if(!t.value){o.add({severity:"warn",summary:"Warning",detail:"Nama toko harus diisi",life:3e3});return}if(t.value.length>25){o.add({severity:"warn",summary:"Warning",detail:"Nama toko tidak boleh lebih dari 25 karakter",life:3e3});return}await B.createStore({name:t.value}),_.value?l.value.visible=!0:l.value.visible=!1,U(),o.add({severity:"success",summary:"Sukses",detail:"Berhasil menambah toko",life:3e3}),h.emit("data-table:update",{tableName:"table-store"})}catch(v){console.error("Error creating store:",v),o.add({severity:"error",summary:"Gagal",detail:v?(a=(e=v.response)==null?void 0:e.data)==null?void 0:a.message:"Gagal menambah toko",life:3e3})}},$=async()=>{var e,a;try{if(!t.value||!s.value){o.add({severity:"warn",summary:"Warning",detail:"Nama toko harus diisi",life:3e3});return}if(t.value.length>25){o.add({severity:"warn",summary:"Warning",detail:"Nama toko tidak boleh lebih dari 25 karakter",life:3e3});return}await B.updateStore(s.value.id,{name:t.value}),l.value.visible=!1,U(),o.add({severity:"success",summary:"Sukses",detail:"Berhasil mengubah toko",life:3e3}),h.emit("data-table:update",{tableName:"table-store"})}catch(v){console.error("Error updating store:",v),o.add({severity:"error",summary:"Gagal",detail:v?(a=(e=v.response)==null?void 0:e.data)==null?void 0:a.message:"Gagal mengubah toko",life:3e3})}},E=async e=>{var a,v;try{if(e.length===0){o.add({severity:"warn",summary:"Warning",detail:"Tidak ada toko yang dipilih untuk dihapus",life:3e3});return}const g={id:e};await B.deleteStore(g),i.value.visible=!1,y.value=[],o.add({severity:"success",summary:"Berhasil",detail:"Berhasil menghapus toko",life:3e3}),h.emit("data-table:update",{tableName:"table-store"})}catch(g){console.error("Error deleting store:",g),o.add({severity:"error",summary:"Gagal",detail:g?(v=(a=g.response)==null?void 0:a.data)==null?void 0:v.message:"Gagal menghapus toko",life:3e3})}},U=()=>{t.value=void 0};return re(()=>l.value.visible,()=>{l.value.visible||U()},{immediate:!0}),(e,a)=>{var g,O;const v=ue("router-view");return D(),P("div",be,[b("div",ye,[u(j,{menus:A.value},null,8,["menus"]),T.value==="stock"?(D(),H(v,{key:0})):(D(),P(ne,{key:1},[u(X,null,{default:J(()=>[b("div",ge,[b("div",he,[b("div",ke,[u(K,{"selected-data":y.value,"onUpdate:selectedData":a[0]||(a[0]=f=>y.value=f),options:F.value,"table-name":"table-store"},null,8,["selected-data","options"]),b("div",_e,[u(ce,{"table-name":"table-store"}),u(ve,{"table-name":"table-store"}),me(N)("store").create?(D(),H(V,{key:0,onClick:r,label:"Tambah Toko",severity:"primary",class:"text-xs"})):de("",!0)])]),u(pe,{"table-name":"table-store"}),u(W,{"data-key":"id","fetch-function":p,columns:M,options:S.value,onToggleOption:a[1]||(a[1]=f=>s.value=f),"onUpdate:selectedData":a[2]||(a[2]=f=>y.value=f),"table-name":"table-store","selection-type":"checkbox","use-paginator":""},null,8,["options"])])])]),_:1}),u(q,{visible:l.value.visible,"onUpdate:visible":[a[4]||(a[4]=f=>l.value.visible=f),l.value.visible],header:(g=l.value)==null?void 0:g.header,class:"w-[400px] !bg-white !border-none text-black","use-stay":(O=l.value)==null?void 0:O.useStay,"use-close":!0,closable:!1,onSubmit:n},{default:J(()=>[b("div",we,[u(Q,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=f=>t.value=f),label:"Nama Toko",placeholder:"Masukkan nama toko"},null,8,["modelValue"])])]),_:1},8,["visible","header","use-stay","onUpdate:visible"]),u(z,{visible:i.value.visible,"onUpdate:visible":a[5]||(a[5]=f=>i.value.visible=f),onConfirm:c,header:i.value.header,"header-icon":"check",list:i.value.list,message:i.value.message,severity:i.value.severity,"confirm-button-severity":i.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64))])])}}});export{Qe as default};
