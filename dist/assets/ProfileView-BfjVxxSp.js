import{u as z,E as K,N as R,v as c,M as G,c as V,y as a,b as f,w as E,o as b,D as O,O as q,z as x,p as B,x as $,t as P,P as A}from"./index-D0kyVKE3.js";import{_ as H}from"./Card.vue_vue_type_script_setup_true_lang-B2Fg2rIi.js";import{_ as J}from"./FileUpload.vue_vue_type_style_index_0_lang-DHDMQsJk.js";import{_ as L}from"./Icon.vue_vue_type_script_setup_true_lang-CIJcKPCf.js";import{_ as S}from"./Image.vue_vue_type_script_setup_true_lang-IncsFajr.js";import{_ as Q}from"./InputPassword.vue_vue_type_script_setup_true_lang-CJaunEi-.js";import{_ as W}from"./InputText.vue_vue_type_script_setup_true_lang-Z4vrXTKL.js";import{c as X}from"./auth.service-DYU0IJcd.js";import{U as C}from"./user.service-8DVaG-Jb.js";import{s as Y}from"./index-GVFA0IfA.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-17VWM07k.js";import"./index-BjILffB_.js";import"./index-U8CqaE2C.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-CeMQ1Gr4.js";import"./index-CKi-uGK0.js";import"./index-DhBWmuYu.js";import"./index-DXG9-4sJ.js";import"./api.service-JsBcWNcF.js";const M={class:"w-full bg-[#eeedf2] profile-view"},ee={class:"flex flex-col gap-2 p-4"},ae={class:"flex flex-col gap-4"},se={class:"text-xl font-bold mb-4"},te={class:"flex gap-14 w-full"},le={class:"w-[30%]"},re={class:"flex flex-col gap-2 w-full"},ie={class:"flex flex-col gap-4 w-full space-y-2 py-8"},oe={class:"flex flex-row gap-2 items-center"},ne={class:"text-base"},ue={class:"flex flex-row gap-2 items-center"},de={class:"text-base"},me={class:"flex flex-row gap-2 items-center"},ve={class:"text-base"},fe={class:"flex flex-row gap-2 items-center"},pe={class:"text-base"},ce={key:0},be={class:"flex flex-col gap-4 px-8"},xe={class:""},ye={class:""},ge={class:""},he={class:""},_e={class:"flex justify-end gap-2 pt-8"},we={key:1,type:"submit",class:"text-xs rounded-sm !px-2 !py-1 bg-green-400 text-white hover:bg-green-400/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-green-500"},ke=z({__name:"ProfileView",setup(Ue){K(()=>{D()});const N=O(),r=R(),t=c(),i=c(),o=c(),n=c(),l=c(),s=c(),m=c(!1),F=()=>{m.value=!m.value},I=()=>{N.back()},j=()=>{i.value=void 0,o.value=void 0,n.value=void 0,l.value=void 0,s.value=void 0},D=async()=>{try{const u=sessionStorage.getItem("users");if(!u){console.error("User ID not found in session storage");return}const{data:e}=await C.getProfile(Number(u));t.value=e.data,i.value=t.value.name,o.value=t.value.username,n.value=t.value.email}catch(u){console.error("Error fetching profile:",u)}},T=async()=>{var u,e,v,y,g,h,_,w,k,U;try{if(!(i!=null&&i.value)){r.add({severity:"warn",summary:"Warning",detail:"Nama harus diisi",life:3e3});return}if(!(o!=null&&o.value)){r.add({severity:"warn",summary:"Warning",detail:"Username harus diisi",life:3e3});return}if(!(n!=null&&n.value)){r.add({severity:"warn",summary:"Warning",detail:"Email harus diisi",life:3e3});return}if(((u=i==null?void 0:i.value)==null?void 0:u.length)>50){r.add({severity:"warn",summary:"Warning",detail:"Nama tidak boleh lebih dari 50 karakter",life:3e3});return}if(((e=o==null?void 0:o.value)==null?void 0:e.length)>15){r.add({severity:"warn",summary:"Warning",detail:"Username tidak boleh lebih dari 15 karakter",life:3e3});return}if(((v=n==null?void 0:n.value)==null?void 0:v.length)>50){r.add({severity:"warn",summary:"Warning",detail:"Email tidak boleh lebih dari 50 karakter",life:3e3});return}if(l!=null&&l.value&&((y=l==null?void 0:l.value)==null?void 0:y.length)<6){r.add({severity:"warn",summary:"Warning",detail:"Password harus minimal 6 karakter",life:3e3});return}if(l!=null&&l.value&&((g=l==null?void 0:l.value)==null?void 0:g.length)>100){r.add({severity:"warn",summary:"Warning",detail:"Password tidak boleh lebih dari 100 karakter",life:3e3});return}if(s!=null&&s.value&&((h=s==null?void 0:s.value)==null?void 0:h.size)>6e5){r.add({severity:"warn",summary:"Warning",detail:"Ukuran foto tidak boleh lebih dari 600KB",life:3e3});return}if(s!=null&&s.value&&!((_=s==null?void 0:s.value)!=null&&_.type.startsWith("image/"))){r.add({severity:"warn",summary:"Warning",detail:"File yang diunggah harus berupa gambar",life:3e3});return}const p={name:i.value,username:o.value,email:n.value,password:l.value,photo:s.value?s.value:null};await C.updateProfile((w=t.value)==null?void 0:w.id,p),r.add({severity:"success",summary:"Sukses",detail:"Berhasil memperbarui profil",life:3e3}),m.value=!0,N.back()}catch(p){r.add({severity:"error",summary:"Error",detail:p?(U=(k=p.response)==null?void 0:k.data)==null?void 0:U.message:"Gagal memperbarui profil",life:3e3})}};return G(()=>m.value,()=>{var u,e,v;m.value||(i.value=(u=t.value)==null?void 0:u.name,o.value=(e=t.value)==null?void 0:e.username,n.value=(v=t.value)==null?void 0:v.email)}),(u,e)=>(b(),V("div",M,[a("div",ee,[e[15]||(e[15]=a("h1",{class:"text-2xl font-bold mb-4"},"Profile",-1)),f(H,{class:"p-4"},{default:E(()=>{var v,y,g,h,_,w,k,U,p;return[a("form",{class:"flex flex-col justify-between",onSubmit:q(T,["prevent"])},[a("div",ae,[a("h1",se,x((v=t.value)==null?void 0:v.name),1),a("div",te,[a("div",le,[(y=t.value)!=null&&y.photo?(b(),B(S,{key:0,src:(g=t.value)==null?void 0:g.photo,class:"object-cover overflow-hidden",type:"default",preview:!0},null,8,["src"])):(b(),B(S,{key:1,class:"object-cover overflow-hidden",src:`${$(X).initialImage}${(h=t.value)==null?void 0:h.username}`,type:"default",preview:!1},null,8,["src"]))]),a("div",re,[a("div",ie,[a("div",oe,[e[6]||(e[6]=a("span",{class:"text-base font-medium w-[100px]"},"Nama",-1)),e[7]||(e[7]=a("span",{class:"text-base font-medium"},":",-1)),a("span",ne,x((_=t.value)==null?void 0:_.name),1)]),a("div",ue,[e[8]||(e[8]=a("span",{class:"text-base font-medium w-[100px]"},"Username",-1)),e[9]||(e[9]=a("span",{class:"text-base font-medium"},":",-1)),a("span",de,x((w=t.value)==null?void 0:w.username),1)]),a("div",me,[e[10]||(e[10]=a("span",{class:"text-base font-medium w-[100px]"},"Email",-1)),e[11]||(e[11]=a("span",{class:"text-base font-medium"},":",-1)),a("span",ve,x((k=t.value)==null?void 0:k.email),1)]),a("div",fe,[e[12]||(e[12]=a("span",{class:"text-base font-medium w-[100px]"},"Posisi",-1)),e[13]||(e[13]=a("span",{class:"text-base font-medium"},":",-1)),a("span",pe,x((p=(U=t.value)==null?void 0:U.roles)==null?void 0:p.name),1)])]),m.value?(b(),V("div",ce,[f($(Y),{align:"center",type:"dotted"},{default:E(()=>e[14]||(e[14]=[a("b",null,"Ubah Profile",-1)])),_:1}),a("div",be,[a("div",xe,[f(W,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=d=>i.value=d),label:"Nama",placeholder:"Masukkan nama"},null,8,["modelValue"])]),a("div",ye,[f(W,{modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=d=>o.value=d),label:"Username",placeholder:"Masukkan username"},null,8,["modelValue"])]),a("div",ge,[f(W,{"model-value":n.value,"onUpdate:modelValue":e[2]||(e[2]=d=>n.value=d),label:"Email",placeholder:"Masukkan Email"},null,8,["model-value"])]),a("div",he,[f(Q,{"model-value":l.value,"onUpdate:modelValue":e[3]||(e[3]=d=>l.value=d),mandatory:!1,label:"Password Baru",placeholder:"Masukkan password"},null,8,["model-value"])]),a("div",null,[f(J,{"model-value":s.value,"onUpdate:modelValue":e[4]||(e[4]=d=>s.value=d),mandatory:!1,label:"Foto",onUpload:e[5]||(e[5]=d=>s.value=d)},null,8,["model-value"])])])])):P("",!0)])])]),a("div",_e,[a("button",{type:"button",onClick:I,class:"text-xs rounded-sm !px-2 !py-1 bg-black text-white hover:bg-black/60 hover:cursor-pointer shadow-md border-1 border-gray-600"}," Kembali "),a("button",{type:"button",onClick:F,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-400 text-white hover:bg-blue-500/60 hover:cursor-pointer shadow-md border-1 border-blue-600"},[A(x(m.value?"Tutup":"Ubah Profile")+" ",1),f(L,{icon:m.value?"close":"edit-2",type:"line"},null,8,["icon"])]),m.value?(b(),V("button",{key:0,type:"button",onClick:j,class:"text-xs rounded-sm !px-2 !py-1 bg-transparent text-red-500 hover:bg-red-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-red-500"}," Bersihkan Field ")):P("",!0),m.value?(b(),V("button",we," Submit ")):P("",!0)])],32)]}),_:1})])]))}}),qe=Z(ke,[["__scopeId","data-v-6af57bb1"]]);export{qe as default};
