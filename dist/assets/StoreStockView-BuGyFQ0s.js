import{_ as R}from"./Badge.vue_vue_type_script_setup_true_lang-BSKQkbi2.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as U}from"./api.service-Dgs1boU1.js";import{_ as L}from"./DataTable.vue_vue_type_script_setup_true_lang-DU7Bh_T0.js";import{S as B}from"./stock.service-C4NW6Gnu.js";import{S as q}from"./store.service-DK6LsYTS.js";import{f as T}from"./data.utils-Cp1LBIu0.js";import{u as C,v as u,a5 as j,y as I,K as z,q as H,a6 as G,o as A,c as K,z as r,b as d,a7 as Q,M as W,p as V,w as X,A as Y,t as Z,x as ee,a4 as te,E as ae}from"./index-DOh3iN_U.js";import{_ as oe,a as le}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-D-p7qWfa.js";import{_ as P}from"./DatePicker.vue_vue_type_script_setup_true_lang-DWsIWa76.js";import{e as y}from"./index-CFjhT2rJ.js";import{_ as x}from"./MultiSelect.vue_vue_type_script_setup_true_lang-kuuDsZfP.js";import"./auth.service-BxJEy6Ur.js";import"./Icon.vue_vue_type_script_setup_true_lang-MXjzyZbO.js";import"./Animation-Bi2SbY78.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BE2iSHdx.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-QsIXXSH_.js";const se={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},re=C({inheritAttrs:!1,__name:"StoreStockFilterFields",props:{id:{},tableName:{default:"product-table"}},emits:["apply"],setup(O,{emit:k}){const v=u(4),c=u(),m=u(),p=u(),h=u([]),g=u([]),S=u([{label:"Aktif",value:"active"},{label:"Tidak Aktif",value:"inactive"}]),n=u([]),i=u([]),e=j(!1),l=u(null),o=O,b=k;I(()=>{M(),y.on("show-filter",$)}),z(()=>{y.off("show-filter",$)});const F=()=>{const s={};if(y.emit("multi-select:hide-overlay"),c.value&&c.value.length>0&&(s.brand=JSON.stringify(c.value)),m.value&&m.value.length>0&&(s.product=JSON.stringify(m.value)),p.value&&p.value.length>0&&(s.status=JSON.stringify(p.value)),n.value&&n.value.length>0){const t=n.value[0]?new Date(n.value[0]):null,a=n.value[1]?new Date(n.value[1]):new Date(n.value[0]),f=[t];a&&f.push(a),s.updatedAt=JSON.stringify(f)}if(i.value&&i.value.length>0){const t=i.value[0]?new Date(i.value[0]):null,a=i.value[1]?new Date(i.value[1]):new Date(i.value[0]),f=[t];a&&f.push(a),s.createdAt=JSON.stringify(f)}y.emit("data-table:apply-filter",{tableName:o==null?void 0:o.tableName,filter:s}),y.emit("data-table:clear-selected-data",{tableName:o==null?void 0:o.tableName}),b==null||b("apply",s)},J=()=>{c.value=[],m.value=[],p.value=[],n.value=[],i.value=[]},$=s=>{s.tableName===o.tableName&&(e.value=s.show)},M=()=>{if(l.value){const{children:s}=l.value,t=l.value.childElementCount,a=t%v.value;let[f,_]=[1,1];for(const D in Array.from({length:t})){const E=Number(D)===t-1;s[D].setAttribute("style",`grid-area: ${f}/${E&&a?v.value:_}`),++_>v.value&&(_=1,f++)}}},w=async s=>{try{let t={};s==="brand"&&(t.brand=JSON.stringify(!0)),s==="product"&&(t.product=JSON.stringify(!0)),s==="status"&&(S.value=[{label:"Tersedia",value:"available"},{label:"Stok Rendah",value:"lowStock"},{label:"Habis",value:"outOfStock"}]);const{data:a}=await B.getStoreStockOptionsById(o==null?void 0:o.id,t);h.value=a.data.brand,g.value=a.data.product}catch(t){console.error("Error fetching filter options:",t)}};return(s,t)=>H((A(),K("div",{ref_key:"container",ref:l,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:Q(`grid-template-columns: repeat(${v.value}, 1fr)`)},[r("div",null,[d(x,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=a=>m.value=a),options:g.value,onShow:t[1]||(t[1]=a=>w("product")),controls:"",label:"Produk",placeholder:"Pilih Produk","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),r("div",null,[d(x,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=a=>c.value=a),options:h.value,onShow:t[3]||(t[3]=a=>w("brand")),controls:"",label:"Brand",placeholder:"Pilih Brand","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),r("div",null,[d(x,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=a=>p.value=a),options:S.value,onShow:t[5]||(t[5]=a=>w("status")),controls:"",label:"Status",placeholder:"Pilih Status","option-label":"label","option-value":"value"},null,8,["modelValue","options"])]),r("div",null,[d(P,{"model-value":n.value,"onUpdate:modelValue":t[6]||(t[6]=a=>n.value=a),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),r("div",null,[d(P,{"model-value":i.value,"onUpdate:modelValue":t[7]||(t[7]=a=>i.value=a),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),r("div",se,[d(N,{onClick:J,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),d(N,{onClick:F,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[G,e.value]])}}),ne={class:"flex flex-col gap-3 text-black"},ie={class:"flex flex-row gap-1 w-fit"},ue={class:"text-sm text-center"},de={class:"flex flex-col gap-2"},ce={class:"flex flex-row justify-start gap-2"},me={class:"w-full flex justify-end gap-2"},Me=C({__name:"StoreStockView",setup(O){I(()=>{n()});const k=ae(),v=W(),c=u(),m=u(),p=[{field:"product.name",header:"Nama Produk",sortable:!0},{field:"product.brand.name",header:"Merek",sortable:!0,bodyTemplate:e=>{var l,o,b;return(l=e.product)!=null&&l.brand?(b=(o=e.product)==null?void 0:o.brand)==null?void 0:b.name:"-"}},{field:"quantity",header:"Jumlah Stok",sortable:!0,bodyTemplate:e=>e.quantity!==void 0?e.quantity.toLocaleString():"-"},{field:"status",header:"Status",sortable:!0,bodyComponent:e=>{var l,o;return{component:R,props:{label:((l=g(e.status))==null?void 0:l.charAt(0).toUpperCase())+((o=g(e.status))==null?void 0:o.slice(1)),severity:h(e.status)}}}},{field:"updatedAt",header:"Terakhir Diubah",sortable:!0,bodyTemplate:e=>e.updatedAt?T(new Date(e.updatedAt)):"-"},{field:"createdAt",header:"Tanggal Dibuat",sortable:!0,bodyTemplate:e=>e.createdAt?T(new Date(e.createdAt)):"-"}],h=e=>{switch(e){case"outOfStock":return"danger";case"lowStock":return"warning";default:return"success"}},g=e=>{switch(e){case"outOfStock":return"Habis";case"lowStock":return"Stok Rendah";default:return"Tersedia"}},S=()=>{k.push("/manage-product/product-in/add")},n=async()=>{try{const e=sessionStorage.getItem("store");if(!e){console.error("Store ID not found in session storage");return}m.value=Number(e);const{data:l}=await q.getStoreById(Number(e));c.value=l.data}catch(e){console.error("Error fetching store:",e)}},i=async e=>{try{const l=sessionStorage.getItem("store");if(!l){v.add({severity:"error",summary:"Error",detail:"Store ID not found in session storage",life:3e3});return}const{data:o}=await B.getStoreStockList(e,Number(l));return o}catch(l){console.error("Error fetching store stock:",l)}};return(e,l)=>(A(),V(U,null,{default:X(()=>{var o;return[r("div",ne,[r("div",ie,[l[0]||(l[0]=r("span",{class:"text-sm font-semibold"},"Daftar Stok Pada: ",-1)),r("span",ue,Y((o=c.value)==null?void 0:o.name),1)]),r("div",de,[r("div",ce,[r("div",me,[d(oe,{"table-name":"table-store-stock"}),d(le,{"table-name":"table-store-stock"}),ee(te)("product_in").create?(A(),V(N,{key:0,onClick:S,label:"Tambah Stock",severity:"primary",class:"text-xs"})):Z("",!0)])]),d(re,{"table-name":"table-store-stock",id:m.value},null,8,["id"]),d(L,{"data-key":"id","fetch-function":i,columns:p,"use-options":!1,"table-name":"table-store-stock","selection-type":"single","use-paginator":""})])])]}),_:1}))}});export{Me as default};
