import{_ as C}from"./Button.vue_vue_type_script_setup_true_lang-Dh7jfG_D.js";import{_ as R}from"./Card.vue_vue_type_script_setup_true_lang-B8PURPzj.js";import{_ as E}from"./DataTable.vue_vue_type_script_setup_true_lang-D77y3HgS.js";import{_ as V}from"./DialogConfirm.vue_vue_type_style_index_0_lang-DhdDtPQL.js";import{f as A,a as L}from"./data.utils-eGwCzW_2.js";import{u as F,v,a5 as O,E as U,L as G,q as H,a6 as J,o as S,c as M,a7 as j,y as f,b as c,N as q,I as $,K as w,D as K,J as W,p as D,w as z,F as Q,r as X,t as Y,x as Z}from"./index-DuqMkg4i.js";import{S as N}from"./stock.service-FGM5fSqI.js";import{_ as P}from"./DatePicker.vue_vue_type_script_setup_true_lang-hjH7K3e2.js";import{e as g}from"./index-CFjhT2rJ.js";import{_ as ee,a as ae}from"./ButtonSearch.vue_vue_type_script_setup_true_lang-DVuCfhT2.js";import{_ as te}from"./Badge.vue_vue_type_script_setup_true_lang-c32mXRSU.js";import"./Icon.vue_vue_type_script_setup_true_lang-DIZdKOaf.js";import"./Animation-DlRldYrW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BzWzbJP8.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-BKnS3hZE.js";import"./index-DSPpt8Dk.js";import"./index-CxOcdtD_.js";import"./index-BuCuFxRa.js";import"./index-BJdiuMEp.js";import"./index-DunXWRsd.js";import"./index-JRkt3G-F.js";import"./api.service-C54YsUjA.js";import"./index-D3QVXGA5.js";import"./InputText.vue_vue_type_script_setup_true_lang-3JzyQCM6.js";const se={class:"flex items-end justify-end gap-2","data-wv-section":"filteractionbuttons",style:{"grid-area":"2/4"}},re=F({inheritAttrs:!1,__name:"ProductInFilterFields",props:{tableName:{default:"product-table"}},emits:["apply"],setup(I,{emit:_}){const y=v(4),l=v([]),a=v([]),u=v([]),b=O(!1),s=v(null),p=I,h=_;U(()=>{x(),g.on("show-filter",k)}),G(()=>{g.off("show-filter",k)});const T=()=>{const n={};if(g.emit("multi-select:hide-overlay"),l.value&&l.value.length>0){const r=l.value[0]?new Date(l.value[0]):null,i=l.value[1]?new Date(l.value[1]):new Date(l.value[0]),o=[r];i&&o.push(i),n.date=JSON.stringify(o)}if(a.value&&a.value.length>0){const r=a.value[0]?new Date(a.value[0]):null,i=a.value[1]?new Date(a.value[1]):new Date(a.value[0]),o=[r];i&&o.push(i),n.updatedAt=JSON.stringify(o)}if(u.value&&u.value.length>0){const r=u.value[0]?new Date(u.value[0]):null,i=u.value[1]?new Date(u.value[1]):new Date(u.value[0]),o=[r];i&&o.push(i),n.createdAt=JSON.stringify(o)}g.emit("data-table:apply-filter",{tableName:p==null?void 0:p.tableName,filter:n}),g.emit("data-table:clear-selected-data",{tableName:p==null?void 0:p.tableName}),h==null||h("apply",n)},B=()=>{l.value=[],a.value=[],u.value=[]},k=n=>{n.tableName===p.tableName&&(b.value=n.show)},x=()=>{if(s.value){const{children:n}=s.value,r=s.value.childElementCount,i=r%y.value;let[o,e]=[1,1];for(const t in Array.from({length:r})){const m=Number(t)===r-1;n[t].setAttribute("style",`grid-area: ${o}/${m&&i?y.value:e}`),++e>y.value&&(e=1,o++)}}};return(n,r)=>H((S(),M("div",{ref_key:"container",ref:s,class:"grid gap-4 py-2 bg-[#5080e1]/10 rounded-md px-3",style:j(`grid-template-columns: repeat(${y.value}, 1fr)`)},[f("div",null,[c(P,{"model-value":l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),label:"Tanggal Transaksi",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),f("div",null,[c(P,{"model-value":a.value,"onUpdate:modelValue":r[1]||(r[1]=i=>a.value=i),label:"Terakhir Diubah",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),f("div",null,[c(P,{"model-value":u.value,"onUpdate:modelValue":r[2]||(r[2]=i=>u.value=i),label:"Dibuat Pada",placeholder:"Pilih Tanggal",showIcon:"",fluid:"","selection-mode":"range",iconDisplay:"input"},null,8,["model-value"])]),f("div",se,[c(C,{onClick:B,label:"Bersihkan Fields","data-wv-section":"clearbutton",severity:"secondary",class:"text-xs"}),c(C,{onClick:T,label:"Terapkan Filter","data-wv-section":"applybutton",severity:"success",class:"text-xs"})])],4)),[[J,b.value]])}}),ie={class:"flex flex-col gap-2 text-black"},le={class:"flex flex-col gap-2"},ne={class:"flex flex-row justify-start gap-2"},oe={class:"w-full flex justify-end gap-2"},Fe=F({__name:"ProductInView",setup(I){const _=K(),y=W(),l=q(),a=v(),u=v([]),b=v([]),s=v({visible:!1,header:"",severity:"success",confirmButtonSeverity:"success"}),p=e=>{switch(e){case"completed":return"Selesai";default:return"Pending"}},h=e=>{switch(e){case"completed":return"success";default:return"warning"}},T=$(()=>{var e,t,m;return[{label:"Edit",icon:"edit",visible:((e=a==null?void 0:a.value)==null?void 0:e.status)!=="completed"&&w("product_in").update,command:()=>{var d;sessionStorage.setItem("productIn",String((d=a.value)==null?void 0:d.id)),_.push("/manage-product/product-in/edit")}},{label:"Tandai Selesai",icon:"check",visible:((t=a==null?void 0:a.value)==null?void 0:t.status)!=="completed"&&w("product_in").update,command:()=>{b.value=[a.value],s.value={visible:!0,header:"Tandai Barang Masuk Selesai",severity:"success",confirmButtonSeverity:"success",message:"Apakah kamu yakin ingin menandai barang masuk ini sebagai selesai?",list:b.value.map(d=>d.transactionCode),confirmLabel:"Tandai Selesai",actionable:!0}}},{label:"Hapus",icon:"delete-bin",danger:!0,visible:((m=a==null?void 0:a.value)==null?void 0:m.status)!=="completed"&&w("product_in").delete,command:()=>{b.value=[a.value],s.value={visible:!0,header:"Hapus Barang Masuk",severity:"error",confirmButtonSeverity:"danger",message:"Apakah kamu yakin ingin menghapus barang masuk ini?",list:b.value.map(d=>d.transactionCode),confirmLabel:"Hapus",actionable:!0}}}]}),B=[{header:"Kode Transaksi",field:"transactionCode",sortable:!0},{header:"Tanggal Transaksi",field:"date",sortable:!0,bodyTemplate:e=>e.date?A(new Date(e.date)):"-"},{header:"Status",field:"status",sortable:!0,bodyComponent:e=>({component:te,props:{label:p(e.status),severity:h(e.status)}})},{header:"Barang",field:"product.name",sortable:!0,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(m=>({value:`${m.name}`}))}}},{header:"Qty",field:"product.quantity",sortable:!0,preset:{type:"multirow",fieldAttributes:e=>{var t;return(t=e==null?void 0:e.products)==null?void 0:t.map(m=>({value:`${m.quantity}`}))}}},{header:"Masuk Ke",field:"toStore.name",sortable:!0,bodyTemplate:e=>e.toWarehouse!==null?L(e.toWarehouse,e.toStore):"-"},{header:"Terakhir Diubah",field:"updatedAt",sortable:!0,bodyTemplate:e=>e.updatedAt?A(new Date(e.updatedAt)):"-"},{header:"Dibuat Pada",field:"createdAt",sortable:!0,bodyTemplate:e=>e.createdAt?A(new Date(e.createdAt)):"-"},{field:"user.name",header:"Dibuat Oleh",sortable:!0,bodyTemplate:e=>e.user?e.user.name:"-"}],k=$(()=>y.path.split("/").pop()),x=()=>{_.push("/manage-product/product-in/add")},n=async()=>{s.value.header==="Tandai Barang Masuk Selesai"?await i():s.value.header==="Hapus Barang Masuk"&&await o()},r=async e=>{try{const{data:t}=await N.getStockIn(e);return t}catch(t){console.error("Error fetching data:",t)}},i=async()=>{try{if(a.value===void 0){l.add({severity:"warn",summary:"Peringatan",detail:"Tidak ada barang masuk yang dipilih untuk diverifikasi.",life:3e3});return}await N.patchStockIn(a==null?void 0:a.value.id),l.add({severity:"success",summary:"Berhasil",detail:"Barang masuk berhasil diverifikasi.",life:3e3}),s.value.visible=!1,g.emit("data-table:update",{tableName:"table-product-in"})}catch(e){console.error("Error verifying product in:",e),l.add({severity:"error",summary:"Gagal",detail:"Gagal memverifikasi barang masuk.",life:3e3})}},o=async()=>{var e;try{if(a.value===void 0){l.add({severity:"warn",summary:"Warning",detail:"Tidak ada barang masuk yang dipilih untuk dihapus.",life:3e3});return}await N.deleteStockIn((e=a==null?void 0:a.value)==null?void 0:e.id),l.add({severity:"success",summary:"Berhasil",detail:"Barang masuk berhasil dihapus.",life:3e3}),s.value.visible=!1,g.emit("data-table:update",{tableName:"table-product-in"})}catch(t){console.error("Error deleting product in:",t),l.add({severity:"error",summary:"Gagal",detail:"Gagal menghapus barang masuk.",life:3e3})}};return(e,t)=>{const m=X("router-view");return k.value==="add"||k.value==="edit"?(S(),D(m,{key:0})):(S(),M(Q,{key:1},[c(R,null,{default:z(()=>[f("div",ie,[f("div",le,[f("div",ne,[f("div",oe,[c(ee,{"table-name":"table-product-in"}),c(ae,{"table-name":"table-product-in"}),Z(w)("product_in").create?(S(),D(C,{key:0,onClick:x,label:"Tambah Barang Masuk",severity:"primary",class:"text-xs"})):Y("",!0)])]),c(re,{"table-name":"table-product-in"}),c(E,{"data-key":"id","fetch-function":r,columns:B,options:T.value,"use-options":"",onToggleOption:t[0]||(t[0]=d=>a.value=d),"onUpdate:selectedData":t[1]||(t[1]=d=>u.value=d),"table-name":"table-product-in","selection-type":"single","use-paginator":""},null,8,["options"])])])]),_:1}),c(V,{visible:s.value.visible,"onUpdate:visible":t[2]||(t[2]=d=>s.value.visible=d),onConfirm:n,header:s.value.header,"header-icon":"check",list:s.value.list,message:s.value.message,severity:s.value.severity,"confirm-button-severity":s.value.confirmButtonSeverity},null,8,["visible","header","list","message","severity","confirm-button-severity"])],64))}}});export{Fe as default};
