import{_ as T}from"./Card.vue_vue_type_script_setup_true_lang-Bl0DslN5.js";import{_ as I}from"./DataTable.vue_vue_type_script_setup_true_lang-BS6nFKDe.js";import{S as L}from"./stock.service-BcxG16rP.js";import{f as V}from"./data.utils-eGwCzW_2.js";import{_ as $}from"./DatePicker.vue_vue_type_script_setup_true_lang-BCQAJcoL.js";import{_ as M}from"./Icon.vue_vue_type_script_setup_true_lang-CRD0Yvi0.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-CCMaiNve.js";import{e as C}from"./index-CFjhT2rJ.js";import{E as j,a as R}from"./jspdf.plugin.autotable-BkVtuT2X.js";import{s as x}from"./index-D_g3COFb.js";import{u as U,v as p,N as _,p as A,w as J,o as P,y as l,b as m,x as w}from"./index-BGCjVxet.js";import"./Animation-tEbJ7J_3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BOijICIK.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-D-XmK6Ot.js";import"./index-BdQHsZDF.js";import"./index-Di0XHDVR.js";import"./index-c5Mf9KwK.js";import"./api.service-DGtXVYHe.js";import"./index-MGwmnnen.js";import"./index-Bs_0ViQP.js";import"./index-cMUTYv_7.js";const q={class:"flex flex-col gap-3 text-black"},z={class:"flex flex-col gap-2 pt-2"},E={class:"flex flex-row justify-start gap-2 w-full items-center"},H={class:"pr-4"},K={class:"flex gap-4 py-1 !text-xs"},O={class:"flex items-center gap-2"},Q={class:"flex items-center gap-2"},Y={class:"grid grid-cols-2 gap-2 w-full"},G={class:"w-full flex justify-end gap-2"},W={class:"flex items-center gap-1"},xe=U({__name:"ReportProductInView",setup(X){const s=p("date"),t=p(),v=p([]),h=p([["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Tujuan Barang"]]),c=p([]),D=[{field:"date",header:"Tanggal Transaksi",sortable:!1,bodyTemplate:a=>a.date?V(new Date(a.date)):"-"},{field:"product.code",header:"Kode Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:a=>{var e;return(e=a==null?void 0:a.products)==null?void 0:e.map(o=>({value:`${o.code}`}))}}},{field:"product.name",header:"Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:a=>{var e;return(e=a==null?void 0:a.products)==null?void 0:e.map(o=>({value:`${o.name}`}))}}},{field:"product.quantity",header:"Jumlah Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:a=>{var e;return(e=a==null?void 0:a.products)==null?void 0:e.map(o=>({value:`${o.quantity}`}))}}},{field:"toStore",header:"Tujuan Barang",sortable:!1,bodyTemplate:a=>a.toStore?a==null?void 0:a.toStore:"-"}],k=()=>{var e;const a={};if(t.value&&t.value&&((e=t==null?void 0:t.value)==null?void 0:e.length)>0){if(s.value==="month"){let u=new Date(t.value[0]);u.setDate(u.getDate()+1),u.setHours(0,0,0,0);let i=new Date(t.value[1]);i.setDate(i.getDate()+1),i.setHours(0,0,0,0)}let o=t.value[0],r=t.value[1]?new Date(t.value[1]):new Date(t.value[0]);s.value==="month"&&(o==null||o.setDate(1),r==null||r.setMonth(r.getMonth()+1),r==null||r.setDate(0),r==null||r.setHours(23,59,59,999));const g=[o];r&&g.push(r),a.date=JSON.stringify(g),C.emit("data-table:apply-filter",{tableName:"table-report-product-in",filter:a})}},B=()=>{var u,i,y,b;const a=new j;let e="";if(t.value&&t.value.length>0){const n=t.value[0],d=t.value[1]||new Date(t.value[0]);s.value==="month"?e=((u=t==null?void 0:t.value)==null?void 0:u.length)>1&&!((i=t==null?void 0:t.value)!=null&&i.includes(null))?`${n.toLocaleDateString("id-ID",{month:"long",year:"numeric"})} - ${d.toLocaleDateString("id-ID",{month:"long",year:"numeric"})}`:n.toLocaleDateString("id-ID",{month:"long",year:"numeric"}):e=((y=t==null?void 0:t.value)==null?void 0:y.length)>1&&!((b=t==null?void 0:t.value)!=null&&b.includes(null))?`${n.toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"})} - ${d.toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"})}`:n.toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"})}a.text("Laporan Barang Masuk",105,10,{align:"center"}),a.text("Agen Sembako Mbak Endang",105,20,{align:"center"}),a.text(e,105,30,{align:"center"});let o=[];for(const n of v.value){const d=new Date(n.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});for(const f of n.products)o.push({date:d,code:f.code,productName:f.name,totalQty:f.quantity,toStore:n.toStore})}o.map((n,d)=>{c.value.push([d+1,n.date,n.code,n.productName,n.totalQty.toString(),n.toStore])}),R(a,{head:h.value,body:c.value,styles:{fontSize:9},headStyles:{fillColor:[0,123,255]},margin:{top:40}});const r=a.output("blob"),g=URL.createObjectURL(r);window.open(g),c.value=[]},S=async a=>{var e;try{const{data:o}=await L.getStockInReport(a);return v.value=((e=o==null?void 0:o.data)==null?void 0:e.data)||[],o}catch(o){console.error("Error fetching store stock:",o)}};return _(()=>t.value,()=>{c.value=[],h.value=[["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Tujuan Barang"]]},{immediate:!0}),_(()=>s.value,()=>{s.value&&(t.value=void 0)},{immediate:!0}),(a,e)=>(P(),A(T,null,{default:J(()=>[l("div",q,[e[7]||(e[7]=l("div",{class:"flex flex-row gap-1 w-fit"},[l("span",{class:"text-lg font-semibold"},"Laporan Barang Masuk")],-1)),l("div",z,[l("div",E,[l("div",H,[e[5]||(e[5]=l("span",{class:"text-xs"},"Filter Berdasarkan",-1)),l("div",K,[l("div",O,[m(w(x),{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),inputId:"date",name:"date",value:"date",size:"small"},null,8,["modelValue"]),e[3]||(e[3]=l("label",{for:"warehouse"},"Tanggal",-1))]),l("div",Q,[m(w(x),{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value=o),inputId:"month",name:"month",value:"month",size:"small"},null,8,["modelValue"]),e[4]||(e[4]=l("label",{for:"store"},"Bulan",-1))])])]),l("div",Y,[l("div",null,[m($,{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value=o),view:s.value==="date"?"date":"month",dateFormat:s.value==="date"?"dd MM yy":"MM yy",placeholder:s.value==="date"?"Pilih Tanggal Transaksi":"Pilih Bulan & Tahun Transaksi","selection-mode":"range"},null,8,["modelValue","view","dateFormat","placeholder"])]),l("div",null,[m(N,{onClick:k,label:"Terapkan",severity:"primary",class:"text-xs"})])]),l("div",G,[l("button",{onClick:B,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-500 text-white hover:bg-blue-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-blue-600"},[l("div",W,[m(M,{icon:"printer"}),e[6]||(e[6]=l("span",null,"Cetak Laporan",-1))])])])]),m(I,{"data-key":"id","fetch-function":S,columns:D,"use-options":!1,"table-name":"table-report-product-in","selection-type":"single","use-paginator":""})])])]),_:1}))}});export{xe as default};
