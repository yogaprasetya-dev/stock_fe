import{_ as c}from"./Button.vue_vue_type_script_setup_true_lang-C1Ovgw-s.js";import{_ as V}from"./api.service-Dgs1boU1.js";import{_ as M}from"./Dropdown.vue_vue_type_script_setup_true_lang-6IRzW13W.js";import{_ as R}from"./FileUpload.vue_vue_type_script_setup_true_lang--lqHwBVE.js";import{_ as B}from"./InputPassword.vue_vue_type_script_setup_true_lang-DvSZWWFt.js";import{_ as f}from"./InputText.vue_vue_type_script_setup_true_lang-e6c03x4O.js";import{U as b}from"./user.service-o5zC87Vg.js";import{u as I,M as N,v as l,y as $,p as C,w as S,o as F,z as t,b as s,E as D}from"./index-DOh3iN_U.js";import{R as G}from"./role.service-Cps6zKxP.js";import{e as O}from"./data.utils-Cp1LBIu0.js";import"./auth.service-BxJEy6Ur.js";import"./index-HQkD5G-S.js";import"./index-CC8nIHWH.js";import"./index-__IG_7Gg.js";import"./index-QsIXXSH_.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-DO9keWeT.js";import"./index-LYmElTQ-.js";import"./index-4eifDWYF.js";import"./index-BAxbCUjW.js";const P={class:"flex flex-col"},j={class:"grid grid-cols-2 gap-2"},z={class:"pr-4"},L={class:""},T={class:"pr-4"},q={class:""},A={class:"flex flex-col gap-2 pr-4"},H={class:"flex justify-end mt-4 gap-2"},pe=I({__name:"EditUserView",setup(J){const r=N(),U=D(),v=l();$(()=>{k(),w(),_()});const i=l(),d=l(),u=l(),p=l(),n=l(),m=l(),h=l(),y=l(),k=()=>{const a=sessionStorage.getItem("users");a&&(v.value=Number(a))},g=()=>{U.push("/settings/users")},E=()=>{i.value=void 0,d.value=void 0,u.value=void 0,p.value=void 0,n.value=void 0,m.value=void 0},w=async()=>{try{const a=sessionStorage.getItem("users");if(!a){r.add({severity:"error",summary:"Error",detail:"ID pengguna tidak ditemukan",life:3e3});return}const{data:e}=await b.getUserDetail(Number(a));h.value=e.data.id,i.value=e.data.name,d.value=e.data.username,u.value=e.data.email,n.value=e.data.photo?await O(e.data.photo):void 0,m.value={name:e.data.roles.name,id:e.data.roles.id}}catch(a){console.error("Error fetching user:",a),r.add({severity:"error",summary:"Error",detail:"Gagal memuat data pengguna",life:3e3})}},_=async()=>{try{const{data:a}=await G.getRoleDropdown();y.value=a.data}catch{r.add({severity:"error",summary:"Error",detail:"Gagal memuat data role",life:3e3})}},x=async()=>{var a;try{if(!i.value){r.add({severity:"error",summary:"Error",detail:"Nama harus diisi",life:3e3});return}if(!d.value){r.add({severity:"error",summary:"Error",detail:"Username harus diisi",life:3e3});return}if(!u.value){r.add({severity:"error",summary:"Error",detail:"Email harus diisi",life:3e3});return}if(!m.value){r.add({severity:"error",summary:"Error",detail:"Role harus dipilih",life:3e3});return}const e={name:i.value,username:d.value,email:u.value,password:p.value,photo:n.value,role:(a=m.value)==null?void 0:a.id};console.log("Updating user with body:",e),await b.updateUser(v==null?void 0:v.value,e),r.add({severity:"success",summary:"Success",detail:"Pengguna berhasil diperbarui",life:3e3}),g()}catch(e){console.error("Error updating user:",e),r.add({severity:"error",summary:"Error",detail:"Gagal memperbarui pengguna",life:3e3})}};return(a,e)=>(F(),C(V,null,{default:S(()=>[t("div",P,[t("div",j,[t("div",z,[s(f,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value=o),label:"Nama",placeholder:"Masukkan nama"},null,8,["modelValue"])]),t("div",L,[s(f,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value=o),label:"Username",placeholder:"Masukkan username"},null,8,["modelValue"])]),t("div",T,[s(f,{"model-value":u.value,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value=o),label:"Email",placeholder:"Masukkan Email"},null,8,["model-value"])]),t("div",q,[s(B,{"model-value":p.value,"onUpdate:modelValue":e[3]||(e[3]=o=>p.value=o),mandatory:!1,label:"Password Baru",placeholder:"Masukkan password"},null,8,["model-value"])]),t("div",A,[s(M,{"model-value":m.value,"onUpdate:modelValue":e[4]||(e[4]=o=>m.value=o),label:"Role",options:y.value,onOpen:_},null,8,["model-value","options"]),s(R,{"model-value":n.value,"onUpdate:modelValue":e[5]||(e[5]=o=>n.value=o),mandatory:!1,label:"Foto",onUpload:e[6]||(e[6]=o=>n.value=o)},null,8,["model-value"])])]),t("div",H,[s(c,{label:"Bersihkan",severity:"info",class:"text-xs",onClick:E}),s(c,{label:"Batal",severity:"secondary",class:"text-xs",onClick:g}),s(c,{label:"Update",severity:"success",class:"text-xs",onClick:x})])])]),_:1}))}});export{pe as default};
