import{_ as k}from"./Card.vue_vue_type_script_setup_true_lang-Crk-f3gY.js";import{_ as w}from"./DataTable.vue_vue_type_script_setup_true_lang-Bv2GBGut.js";import{S}from"./stock.service-DU24jw1z.js";import{f as T}from"./data.utils-eGwCzW_2.js";import{_ as V}from"./DatePicker.vue_vue_type_script_setup_true_lang-HpdiHGB9.js";import{_ as M}from"./Icon.vue_vue_type_script_setup_true_lang-DQpuTSIJ.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-C3EZ6wIy.js";import{e as $}from"./index-CFjhT2rJ.js";import{E as C,a as L}from"./jspdf.plugin.autotable-Bx7fSw7r.js";import{s as v}from"./index-wcSDmgdM.js";import{u as K,v as u,N as b,p as R,w as U,o as A,y as o,b as n,x as y}from"./index-hWW29s6s.js";import"./Animation-DnZbilmd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-TVW8kvF3.js";import"./InputGroup.vue_vue_type_script_setup_true_lang-Bj-gQ17_.js";import"./index-QJmaLRHl.js";import"./index-BiJc2Fi6.js";import"./index-DKMYSfv0.js";import"./api.service-D-b--VpV.js";import"./index-MGwmnnen.js";import"./index-DfSJzKmE.js";import"./index-BgKJ5Lam.js";const I={class:"flex flex-col gap-3 text-black"},O={class:"flex flex-col gap-2 pt-2"},P={class:"flex flex-row justify-start gap-2 w-full items-center"},j={class:"pr-4"},q={class:"flex gap-4 py-1 !text-xs"},z={class:"flex items-center gap-2"},D={class:"flex items-center gap-2"},E={class:"grid grid-cols-2 gap-2 w-full"},J={class:"w-full flex justify-end gap-2"},Q={class:"flex items-center gap-1"},ve=K({__name:"ReportProductOutView",setup(Y){const s=u("date"),r=u(),f=u([]),g=u([["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang"]]),i=u([]),h=[{field:"date",header:"Tanggal Transaksi",sortable:!1,bodyTemplate:t=>t.date?T(new Date(t.date)):"-"},{field:"product.code",header:"Kode Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:t=>{var e;return(e=t==null?void 0:t.products)==null?void 0:e.map(a=>({value:`${a.code}`}))}}},{field:"product.name",header:"Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:t=>{var e;return(e=t==null?void 0:t.products)==null?void 0:e.map(a=>({value:`${a.name}`}))}}},{field:"product.quantity",header:"Jumlah Barang",sortable:!1,preset:{type:"multirow",fieldAttributes:t=>{var e;return(e=t==null?void 0:t.products)==null?void 0:e.map(a=>({value:`${a.quantity}`}))}}},{field:"fromStore",header:"Sumber Barang",sortable:!1,bodyTemplate:t=>t.fromStore?t==null?void 0:t.fromStore:"-"}],x=()=>{var d,m,l;if(!r.value)return;const t=((d=r==null?void 0:r.value)==null?void 0:d.getMonth())+1,e=(m=r==null?void 0:r.value)==null?void 0:m.getFullYear(),a={month:t,year:e};s.value==="date"&&(a.date=(l=r==null?void 0:r.value)==null?void 0:l.getDate()),$.emit("data-table:apply-filter",{tableName:"table-report-product-out",filter:a})},_=()=>{const t=new C,e=r.value?r.value.toLocaleDateString("id-ID",s.value==="date"?{day:"2-digit",month:"long",year:"numeric"}:{month:"long",year:"numeric"}):"";t.text("Laporan Barang Keluar",105,10,{align:"center"}),t.text("Agen Sembako Mbak Endang",105,20,{align:"center"}),t.text(e,105,30,{align:"center"});let a=[];for(const l of f.value){const p=new Date(l.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});for(const c of l.products)a.push({date:p,code:c.code,productName:c.name,totalQty:c.quantity,fromStore:l.fromStore})}a.map((l,p)=>{i.value.push([p+1,l.date,l.code,l.productName,l.totalQty.toString(),l.fromStore])}),L(t,{head:g.value,body:i.value,styles:{fontSize:9},headStyles:{fillColor:[0,123,255]},margin:{top:40}});const d=t.output("blob"),m=URL.createObjectURL(d);window.open(m),i.value=[]},B=async t=>{var e;try{const{data:a}=await S.getStockOutReport(t);return f.value=((e=a==null?void 0:a.data)==null?void 0:e.data)||[],a}catch(a){console.error("Error fetching store stock:",a)}};return b(()=>r.value,()=>{i.value=[],g.value=[["No","Tanggal Transaksi","Kode Barang","Barang","Jumlah Barang","Sumber Barang"]]}),b(()=>s.value,()=>{s.value&&(r.value=void 0)},{immediate:!0}),(t,e)=>(A(),R(k,null,{default:U(()=>[o("div",I,[e[7]||(e[7]=o("div",{class:"flex flex-row gap-1 w-fit"},[o("span",{class:"text-lg font-semibold"},"Laporan Barang Keluar")],-1)),o("div",O,[o("div",P,[o("div",j,[e[5]||(e[5]=o("span",{class:"text-xs"},"Filter Berdasarkan",-1)),o("div",q,[o("div",z,[n(y(v),{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),inputId:"date",name:"date",value:"date",size:"small"},null,8,["modelValue"]),e[3]||(e[3]=o("label",{for:"warehouse"},"Tanggal",-1))]),o("div",D,[n(y(v),{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),inputId:"month",name:"month",value:"month",size:"small"},null,8,["modelValue"]),e[4]||(e[4]=o("label",{for:"store"},"Bulan",-1))])])]),o("div",E,[o("div",null,[n(V,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),view:s.value==="date"?"date":"month",dateFormat:s.value==="date"?"dd MM yy":"MM yy",placeholder:s.value==="date"?"Pilih Tanggal Transaksi":"Pilih Bulan & Tahun Transaksi"},null,8,["modelValue","view","dateFormat","placeholder"])]),o("div",null,[n(N,{onClick:x,label:"Terapkan",severity:"primary",class:"text-xs"})])]),o("div",J,[o("button",{onClick:_,class:"text-xs rounded-sm !px-2 !py-1 bg-blue-500 text-white hover:bg-blue-500/60 hover:text-white hover:cursor-pointer shadow-md border-1 border-blue-600"},[o("div",Q,[n(M,{icon:"printer"}),e[6]||(e[6]=o("span",null,"Cetak Laporan",-1))])])])]),n(w,{"data-key":"id","fetch-function":B,columns:h,"use-options":!1,"table-name":"table-report-product-out","selection-type":"single","use-paginator":""})])])]),_:1}))}});export{ve as default};
